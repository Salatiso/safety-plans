// assets/js/common.js

// Show/hide steps
export function showStep(stepId) {
    console.log(`Showing step: ${stepId}`);
    document.querySelectorAll(".step").forEach(step => step.classList.add("hidden"));
    document.getElementById(stepId).classList.remove("hidden");
    window.scrollTo(0, 0);
}

// Layout adjustment
export function adjustLayout() {
    console.log("Adjusting layout");
    const headerHeight = document.querySelector("header").offsetHeight || 0;
    const sidebar = document.querySelector(".sidebar");
    const mainContent = document.querySelector(".main-content");
    if (sidebar && mainContent) {
        sidebar.style.top = `${headerHeight}px`;
        sidebar.style.height = `calc(100vh - ${headerHeight}px)`;
        mainContent.style.marginLeft = `${sidebar.offsetWidth}px`;
        mainContent.style.paddingTop = `${headerHeight}px`;
        mainContent.style.minHeight = `calc(100vh - ${headerHeight}px)`;
    }
}

// Initialize layout
window.addEventListener("load", adjustLayout);
window.addEventListener("resize", adjustLayout);

// PDF header/footer
export function addHeaderFooter(doc, pageNum, projectName) {
    doc.setFillColor(26, 37, 38);
    doc.rect(0, 0, 210, 15, "F");
    doc.setTextColor(255, 255, 255);
    doc.setFontSize(12);
    doc.setFont("helvetica", "bold");
    doc.text("Salatiso OHS Tools", 10, 10);
    doc.text(`Page ${pageNum}`, 200, 10, { align: "right" });
    if (pageNum !== 1) {
        doc.setTextColor(200, 200, 200);
        doc.setFontSize(10);
        doc.text("Generated by Salatiso OHS Tools", 105, 148.5, { angle: 45, align: "center" });
    }
    doc.setTextColor(0, 0, 0);
    doc.setFontSize(8);
    doc.setFont("helvetica", "normal");
    doc.text("Â© 2025 Salatiso OHS Tools | salatiso@safetyfirst.help", 105, 290, { align: "center" });
}

// Disable sidebar links
document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll(".sidebar a.disabled").forEach(link => {
        link.addEventListener("click", e => {
            e.preventDefault();
            alert("This feature is coming soon!");
        });
    });
});
