\documentclass[11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[a4paper, margin=2.5cm]{geometry}
\usepackage{fancyhdr}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{noto}
\usepackage{ifthen}

% Branding variables
\newcommand{\brandingLevel}{light}
\newcommand{\userLogo}{}
\newcommand{\userCompany}{{{COMPANY_NAME}}}
\newcommand{\safetyHelpLogo}{/safety-plans/assets/images/logo.png}

% Dynamic fields
\newcommand{\docTitle}{OHS Training Forms and Templates}
\newcommand{\refNumber}{OHSTFT-001}
\newcommand{\issueDate}{{{DATE}}}
\newcommand{\location}{}
\newcommand{\compilerName}{{{COMPILED_BY_NAME}}}
\newcommand{\compilerRole}{{{COMPILED_BY_ROLE}}}
\newcommand{\compilerSACPCMP}{}
\newcommand{\compilerEmail}{{{COMPILED_BY_EMAIL}}}
\newcommand{\compilerPhone}{{{COMPILED_BY_CONTACT}}}
\newcommand{\compilerCompany}{}
\newcommand{\revision}{{{REVISION}}}

% Header and Footer
\pagestyle{fancy}
\fancyhf{}
\ifthenelse{\equal{\brandingLevel}{heavy}}{
  \fancyhead[L]{\small \refNumber}
  \fancyhead[C]{\ifthen\isempty{\userLogo}{\textbf{\userCompany}}{\includegraphics[height=1.5cm]{\userLogo}} \quad \includegraphics[height=1cm]{\safetyHelpLogo}}
  \fancyhead[R]{\small \compilerName}
}{
  \fancyhead[L]{\small \refNumber}
  \fancyhead[C]{\ifthen\isempty{\userLogo}{\textbf{\userCompany}}{\includegraphics[height=1.5cm]{\userLogo}}}
  \fancyhead[R]{\small \compilerName}
}
\fancyfoot[L]{\small \textit{Powered by SafetyHelp | Safety Personalized, Compliance Simplified}}
\fancyfoot[C]{\small \textit{Visit safetyfirst.help | Email: salatiso@safetyfirst.help}}
\fancyfoot[R]{\small Page \thepage\ of 1}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0pt}
\fancyfoot[C]{\parbox[b]{\textwidth}{\footnotesize \textit{This document is generated by SafetyHelp for OHS compliance. Verify applicability with local regulations.}}}

\begin{document}

% Content-Specific Sections
\section*{\docTitle}
\textbf{Reference}: \refNumber \\
\textbf{Issue Date}: \issueDate \\
\textbf{Compiled By}: \compilerName, \compilerRole \\
\textbf{Contact}: \compilerEmail, \compilerPhone

\subsection*{OHS Training Needs Analysis (TNA) Template}

\textbf{Department/Project/Site:} \location \textbf{Date of TNA:} \_\_\_\_ \\
\textbf{Conducted By:} \_\_\_\_ \textbf{Reviewed By (Manager):} \_\_\_\_

\begin{table}[h]
    \centering
    \begin{tabular}{p{2cm}p{3cm}p{2cm}p{2cm}p{3cm}p{2cm}p{2cm}p{2cm}p{2cm}p{2cm}}
        \toprule
        \textbf{Job Role} & \textbf{Key Tasks} & \textbf{Hazards} & \textbf{Required Skills} & \textbf{Training Required} & \textbf{Assessment Method} & \textbf{Legal Reference} & \textbf{Current Training} & \textbf{Training Gap} & \textbf{Priority} \\
        \midrule
        Workshop Technician & Use of grinding machine & Flying particles & Safe machine operation & Machine Guarding & Practical test & OHS Act Sec 8 & Induction & Yes & H \\
        \bottomrule
    \end{tabular}
    \caption{OHS Training Needs Analysis}
\end{table}

\subsection*{OHS Training Plan / Matrix Template}

\textbf{Department/Project/Site:} \location \textbf{Year:} \_\_\_\_ \\
\textbf{Prepared By:} \_\_\_\_ \textbf{Approved By:} \_\_\_\_

\begin{table}[h]
    \centering
    \begin{tabular}{p{2cm}p{2cm}p{2cm}p{2cm}p{2cm}p{2cm}p{2cm}p{2cm}p{2cm}}
        \toprule
        \textbf{Job Role} & \textbf{Employee} & \textbf{General Training} & \textbf{Role-Specific} & \textbf{Hazard-Specific} & \textbf{Emergency Training} & \textbf{Statutory} & \textbf{Refresher Dates} & \textbf{Planned Dates} \\
        \midrule
        All Employees & N/A & OHS Induction & & Basic Hazard ID & Evacuation & & On Hire & On Hire \\
        \bottomrule
    \end{tabular}
    \caption{OHS Training Plan/Matrix}
\end{table}

\subsection*{OHS Training Record / Attendance Register Template}

\textbf{Course Title:} \_\_\_\_ \textbf{Training Provider:} \_\_\_\_ \\
\textbf{Trainer(s) Name(s):} \_\_\_\_ \textbf{Date(s) of Training:} \_\_\_\_ \\
\textbf{Duration (Hours):} \_\_\_\_ \textbf{Location:} \location

\begin{table}[h]
    \centering
    \begin{tabular}{p{1cm}p{3cm}p{2cm}p{2cm}p{2cm}p{2cm}p{2cm}}
        \toprule
        \textbf{No.} & \textbf{Name} & \textbf{Employee No.} & \textbf{Department} & \textbf{Job Title} & \textbf{Signature} & \textbf{Assessment Result} \\
        \midrule
        1 & & & & & & \\
        \bottomrule
    \end{tabular}
    \caption{OHS Training Record/Attendance Register}
\end{table}

\subsection*{General OHS Induction Checklist Template}

\textbf{Employee/Contractor Name:} \_\_\_\_ \textbf{Date:} \_\_\_\_ \\
\textbf{Company (if Contractor):} \_\_\_\_ \textbf{Job Title:} \_\_\_\_ \\
\textbf{Induction Conducted By:} \_\_\_\_

\begin{table}[h]
    \centering
    \begin{tabular}{p{1cm}p{4cm}p{2cm}p{2cm}p{3cm}}
        \toprule
        \textbf{No.} & \textbf{Topic} & \textbf{Covered (âœ”)} & \textbf{Understanding (Initial)} & \textbf{Comments} \\
        \midrule
        1.1 & Company OHS Policy & & & \\
        2.1 & Site Layout & & & \\
        3.1 & Emergency Alarms & & & \\
        \bottomrule
    \end{tabular}
    \caption{General OHS Induction Checklist}
\end{table}

\subsection*{Toolbox Talk Record Form Template}

\textbf{Project/Department/Site:} \location \textbf{Date:} \_\_\_\_ \textbf{Time:} \_\_\_\_ \\
\textbf{Location:} \location \textbf{Supervisor/Presenter:} \_\_\_\_ \\
\textbf{Topic:} \_\_\_\_

\begin{table}[h]
    \centering
    \begin{tabular}{p{1cm}p{3cm}p{3cm}p{3cm}}
        \toprule
        \textbf{No.} & \textbf{Full Name} & \textbf{Company} & \textbf{Signature} \\
        \midrule
        1 & & & \\
        \bottomrule
    \end{tabular}
    \caption{Toolbox Talk Record}
\end{table}

% Signature Section
\subsection*{Signatures}
\begin{itemize}
  \item \textbf{Compiler}: \compilerName \\
    Signature: \rule{5cm}{0.4pt} \quad Date: \rule{3cm}{0.4pt}
  \item \textbf{Approved By}: {{CEO_NAME}} \\
    Signature: \rule{5cm}{0.4pt} \quad Date: \rule{3cm}{0.4pt}
\end{itemize}

\end{document}
