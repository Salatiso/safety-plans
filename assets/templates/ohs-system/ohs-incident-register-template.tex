\documentclass[11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[a4paper, margin=2.5cm]{geometry}
\usepackage{fancyhdr}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{noto}
\usepackage{ifthen}

% Branding variables
\newcommand{\brandingLevel}{light}
\newcommand{\userLogo}{}
\newcommand{\userCompany}{{{COMPANY_NAME}}}
\newcommand{\safetyHelpLogo}{/safety-plans/assets/images/logo.png}

% Dynamic fields
\newcommand{\docTitle}{OHS Incident Register}
\newcommand{\refNumber}{{{YEAR}}-IR}
\newcommand{\issueDate}{{{DATE}}}
\newcommand{\scope}{{{SCOPE}}}
\newcommand{\year}{{{YEAR}}}
\newcommand{\compilerName}{{{COMPILED_BY_NAME}}}
\newcommand{\compilerRole}{{{COMPILED_BY_ROLE}}}
\newcommand{\compilerSACPCMP}{}
\newcommand{\compilerEmail}{{{COMPILED_BY_EMAIL}}}
\newcommand{\compilerPhone}{{{COMPILED_BY_CONTACT}}}
\newcommand{\compilerCompany}{}
\newcommand{\revision}{{{REVISION}}}

% Header and Footer
\pagestyle{fancy}
\fancyhf{}
\ifthenelse{\equal{\brandingLevel}{heavy}}{
  \fancyhead[L]{\small \refNumber}
  \fancyhead[C]{\ifthen\isempty{\userLogo}{\textbf{\userCompany}}{\includegraphics[height=1.5cm]{\userLogo}} \quad \includegraphics[height=1cm]{\safetyHelpLogo}}
  \fancyhead[R]{\small \compilerName}
}{
  \fancyhead[L]{\small \refNumber}
  \fancyhead[C]{\ifthen\isempty{\userLogo}{\textbf{\userCompany}}{\includegraphics[height=1.5cm]{\userLogo}}}
  \fancyhead[R]{\small \compilerName}
}
\fancyfoot[L]{\small \textit{Powered by SafetyHelp | Safety Personalized, Compliance Simplified}}
\fancyfoot[C]{\small \textit{Visit safetyfirst.help | Email: salatiso@safetyfirst.help}}
\fancyfoot[R]{\small Page \thepage\ of 1}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0pt}
\fancyfoot[C]{\parbox[b]{\textwidth}{\footnotesize \textit{This document is generated by SafetyHelp for OHS compliance. Verify applicability with local regulations.}}}

\begin{document}

% Content-Specific Sections
\section*{\docTitle}
\textbf{Register For}: \scope \\
\textbf{Year}: \year \\
\textbf{Version}: \revision \\
\textbf{Maintained By}: \compilerName, \compilerRole \\
\textbf{Contact}: \compilerEmail, \compilerPhone

\subsection*{OHS Incident Register}

\begin{table}[h]
    \centering
    \begin{tabular}{p{1cm}p{2cm}p{2cm}p{2cm}p{2cm}p{3cm}p{2cm}p{2cm}p{2cm}p{2cm}p{2cm}p{2cm}p{2cm}p{2cm}}
        \toprule
        \textbf{ID No.} & \textbf{Date} & \textbf{Time} & \textbf{Location} & \textbf{Person} & \textbf{Description} & \textbf{Type} & \textbf{Injury/Damage} & \textbf{Days Lost} & \textbf{Inv. Report No.} & \textbf{Root Cause} & \textbf{Corrective Actions} & \textbf{CAPA Closed} & \textbf{Statutory Reported} & \textbf{Comments} \\
        \midrule
        & & & & & & & & & & & & & & \\
        \bottomrule
    \end{tabular}
    \caption{OHS Incident Register}
\end{table}

% Signature Section
\subsection*{Signatures}
\begin{itemize}
  \item \textbf{Maintained By}: \compilerName \\
    Signature: \rule{5cm}{0.4pt} \quad Date: \rule{3cm}{0.4pt}
  \item \textbf{Approved By}: {{CEO_NAME}} \\
    Signature: \rule{5cm}{0.4pt} \quad Date: \rule{3cm}{0.4pt}
\end{itemize}

\end{document}
