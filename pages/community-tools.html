<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Report community safety incidents and access tools to improve safety in settings like spaza shops, schools, and hospitals with SafetyHelp.">
    <meta name="keywords" content="community safety tools, incident reporting, occupational health and safety, safety plans, South Africa OHS, SafetyHelp">
    <meta name="author" content="SafetyHelp Team">
    <title data-i18n="page_title.community_tools">SafetyHelp - Community Safety Tools</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/i18next@23.15.2/dist/umd/i18next.min.js"></script>
    <script src="https://unpkg.com/i18next-browser-languagedetector@8.0.0/dist/i18nextBrowserLanguageDetector.min.js"></script>
    <!-- Google Maps API (Placeholder - Replace with actual API key) -->
    <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap" async defer></script>
    <style>
        /* Global Styles */
        body {
            font-family: 'Open Sans', sans-serif;
            background-color: #E8F0FE;
            color: #333;
            margin: 0;
            padding-top: 100px;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        header h1, .sidebar h2, .sidebar h3, .intro h2, footer h3, .incident-report h3, .tools-list h3, .tool h4 {
            font-family: 'Montserrat', sans-serif;
        }
        /* Header */
        header {
            background-color: #007BFF;
            color: white;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 50;
            width: 100%;
        }
        .header-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
        }
        .header-left {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        .search-language-container {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        .search-bar button {
            background-color: #FD7E14;
            color: white;
        }
        .search-bar button:hover {
            background-color: #e06b00;
        }
        .language-selector {
            margin-bottom: 5px;
        }
        .language-selector select {
            padding: 4px;
            border-radius: 4px;
            font-size: 14px;
        }
        .nav-links {
            text-align: center;
            flex: 1;
        }
        .nav-links a {
            color: white;
            margin: 0 15px;
            font-family: 'Montserrat', sans-serif;
            text-decoration: none;
        }
        .nav-links a:hover {
            color: #FD7E14;
        }
        .header-right {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
        }
        .logo-container img {
            height: 50px;
        }
        .tagline {
            font-size: 14px;
            margin-top: 5px;
        }
        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 100px;
            left: 0;
            bottom: 0;
            width: 250px;
            background-color: #F4F4F4;
            overflow-y: auto;
            z-index: 40;
            padding: 15px;
        }
        .sidebar h2 {
            color: #007BFF;
            font-size: 24px;
            margin-bottom: 15px;
            text-align: right;
        }
        .sidebar a {
            color: white;
            background-color: #007BFF;
            padding: 8px;
            border-radius: 4px;
            margin-bottom: 5px;
            display: block;
            text-decoration: none;
            font-size: 14px;
            transition: font-weight 0.3s;
        }
        .sidebar a:hover {
            font-weight: bold;
            background-color: #0056b3;
        }
        .sidebar a.active {
            background-color: #28A745;
        }
        .step-info {
            background-color: #E8F0FE;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
        }
        .step-info h3 {
            font-size: 18px;
            color: #007BFF;
            margin-bottom: 10px;
        }
        .step-info p {
            font-size: 14px;
        }
        .fun-fact {
            color: #28A745;
        }
        /* Main Content */
        .main-content {
            margin-left: 250px;
            flex-grow: 1;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container mx-auto header-container">
            <div class="header-left">
                <div class="logo-container">
                    <img src="/safety-plans/assets/images/logo.png" alt="SafetyHelp Logo">
                    <p class="tagline" data-i18n="header.tagline">Safety Personalized, Compliance Simplified—Anytime, Anywhere</p>
                </div>
            </div>
            <div class="nav-links">
                <a href="/safety-plans/index.html" data-i18n="header.nav.home">Home</a>
                <a href="/safety-plans/resources.html" data-i18n="header.nav.resources">Resources</a>
                <a href="/safety-plans/services.html" data-i18n="header.nav.services">Services</a>
                <a href="/safety-plans/community.html" data-i18n="header.nav.community">Community</a>
                <a href="/safety-plans/about.html" data-i18n="header.nav.about">About</a>
                <a href="/safety-plans/contact.html" data-i18n="header.nav.contact">Contact</a>
                <a href="/safety-plans/login.html" id="login-link" data-i18n="header.nav.login">Login</a>
            </div>
            <div class="header-right">
                <div class="search-language-container">
                    <div class="language-selector">
                        <select id="language-select" aria-label="Select language">
                            <option value="en" data-i18n="language_selector.en">English</option>
                            <option value="af" data-i18n="language_selector.af">Afrikaans</option>
                            <option value="zu" data-i18n="language_selector.zu">isiZulu</option>
                            <option value="xh" data-i18n="language_selector.xh">isiXhosa</option>
                            <option value="st" data-i18n="language_selector.st">Sesotho</option>
                            <option value="tn" data-i18n="language_selector.tn">Setswana</option>
                            <option value="nso" data-i18n="language_selector.nso">Sepedi</option>
                            <option value="ts" data-i18n="language_selector.ts">Xitsonga</option>
                            <option value="ss" data-i18n="language_selector.ss">siSwati</option>
                            <option value="ve" data-i18n="language_selector.ve">Tshivenda</option>
                            <option value="nr" data-i18n="language_selector.nr">isiNdebele</option>
                            <option value="es" data-i18n="language_selector.es">Español</option>
                            <option value="fr" data-i18n="language_selector.fr">French</option>
                            <option value="sn" data-i18n="language_selector.sn">Shona</option>
                            <option value="sw" data-i18n="language_selector.sw">Swahili</option>
                            <option value="zh" data-i18n="language_selector.zh">Mandarin</option>
                        </select>
                    </div>
                    <div class="search-bar">
                        <form role="search" class="flex">
                            <input type="text" data-i18n="[placeholder]header.search.placeholder" placeholder="Search OHS Tools..." aria-label="Search OHS Tools" class="px-3 py-1 border border-gray-300 rounded-l text-gray-800">
                            <button type="submit" aria-label="Search" data-i18n="header.search.button" class="px-4 py-1 bg-blue-500 hover:bg-blue-600 text-white rounded-r">Search</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Sidebar -->
    <aside class="sidebar">
        <h2 data-i18n="sidebar.ohs_tools">SafetyHelp OHS Tools</h2>
        <ul class="space-y-2">
            <li><a href="/safety-plans/pages/construction-compliance.html" data-i18n="sidebar.construction_safety">Construction Safety</a></li>
            <li><a href="/safety-plans/pages/emergency-response-plan.html" data-i18n="sidebar.emergency_planning">Emergency Planning</a></li>
            <li><a href="/safety-plans/pages/risk-assessment.html" data-i18n="sidebar.risk_assessment">Risk Assessment</a></li>
            <li><a href="/safety-plans/pages/legal-appointments.html" data-i18n="sidebar.legal_appointments">Legal Appointments</a></li>
            <li><a href="/safety-plans/pages/incident-management.html" data-i18n="sidebar.incident_management">Incident Management</a></li>
            <li><a href="/safety-plans/pages/training.html" data-i18n="sidebar.training">Training</a></li>
            <li><a href="/safety-plans/pages/inspections-audits.html" data-i18n="sidebar.inspections_audits">Inspections & Audits</a></li>
            <li><a href="/safety-plans/pages/suppliers.html" data-i18n="sidebar.suppliers">Suppliers</a></li>
            <li><a href="/safety-plans/pages/legislation.html" data-i18n="sidebar.legislation">Legislation</a></li>
            <li><a href="/safety-plans/pages/community-tools.html" data-i18n="sidebar.community_tools" class="active">Community Tools</a></li>
            <li><a href="/safety-plans/pages/member-dashboard.html" data-i18n="sidebar.member_dashboard">Member Dashboard</a></li>
            <li><a href="/safety-plans/pages/ohs-system.html" data-i18n="sidebar.ohs_system">OHS System</a></li>
        </ul>
        <div id="sidebar-step-info" class="step-info">
            <h3 data-i18n="sidebar.step_0.title">📜 Community Safety Tools</h3>
            <p data-i18n="sidebar.step_0.description" class="text-sm mb-3">Report incidents like potholes or safety hazards and access tools to improve safety in community settings like spaza shops, schools, and hospitals.</p>
            <p class="fun-fact text-sm" data-i18n="sidebar.step_0.fun_fact">⚡ Did you know timely reporting of community hazards can help prevent accidents and improve public safety?</p>
        </div>
    </aside>

    <!-- Main Content -->
    <div class="main-content">
        <section class="intro">
            <h2 data-i18n="community_tools.title">Community Safety Tools</h2>
            <p data-i18n="community_tools.description">Report any safety incident or hazard in your community or workplace, from potholes to defective equipment. Use our tools to ensure safety in settings like spaza shops, schools, hospitals, and taverns.</p>
        </section>

        <section class="incident-report">
            <h3 data-i18n="community_tools.incident_report.title">Report an Incident or Hazard</h3>
            <form id="incident-report-form" class="space-y-4">
                <div class="form-group">
                    <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="community_tools.incident_report.photo_label">Upload Photo of the Incident (Optional):</label>
                    <input type="file" id="incident-photo" accept="image/*" class="w-full p-2 border border-gray-300 rounded text-sm">
                </div>
                <div class="form-group">
                    <div id="map" style="height: 200px; width: 100%; max-width: 400px;"></div>
                    <p id="location-info" class="text-sm text-gray-600 mt-2" data-i18n="community_tools.incident_report.location_info">Location will be auto-detected...</p>
                    <p id="weather-info" class="text-sm text-gray-600 mt-2" data-i18n="community_tools.incident_report.weather_info">Weather will be auto-detected...</p>
                </div>
                <div class="form-group">
                    <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="community_tools.incident_report.description_label">Incident Description:</label>
                    <textarea id="incident-description" required data-i18n="[placeholder]community_tools.incident_report.description_placeholder" placeholder="Describe the incident or hazard (e.g., pothole on Main Street, broken chair in community center)..." class="w-full p-2 border border-gray-300 rounded text-sm h-24"></textarea>
                </div>
                <div class="form-group">
                    <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="community_tools.incident_report.user_name_label">Your Name (Optional):</label>
                    <input type="text" id="user-name" data-i18n="[placeholder]community_tools.incident_report.user_name_placeholder" placeholder="Enter your name..." class="w-full p-2 border border-gray-300 rounded text-sm">
                </div>
                <div class="form-group">
                    <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="community_tools.incident_report.user_contact_label">Your Contact Details (Optional):</label>
                    <input type="text" id="user-contact" data-i18n="[placeholder]community_tools.incident_report.user_contact_placeholder" placeholder="Enter your phone or email..." class="w-full p-2 border border-gray-300 rounded text-sm">
                </div>
                <div class="form-group">
                    <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="community_tools.incident_report.user_social_label">Your Social Media Handle (Optional, e.g., @username on X):</label>
                    <input type="text" id="user-social" data-i18n="[placeholder]community_tools.incident_report.user_social_placeholder" placeholder="Enter your X handle..." class="w-full p-2 border border-gray-300 rounded text-sm">
                </div>
                <div class="form-group">
                    <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="community_tools.incident_report.service_provider_label">Service Provider (e.g., Municipality):</label>
                    <select id="service-provider" onchange="updateServiceProviderDetails()" class="w-full p-2 border border-gray-300 rounded text-sm">
                        <option value="" data-i18n="community_tools.incident_report.option_select_provider">Select a Service Provider</option>
                        <!-- Populated dynamically -->
                    </select>
                </div>
                <div class="form-group">
                    <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="community_tools.incident_report.provider_contact_label">Service Provider Contact Details (Optional):</label>
                    <input type="text" id="provider-contact" data-i18n="[placeholder]community_tools.incident_report.provider_contact_placeholder" placeholder="Enter phone or email (auto-filled if provider selected)..." class="w-full p-2 border border-gray-300 rounded text-sm">
                </div>
                <div class="form-group">
                    <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="community_tools.incident_report.provider_social_label">Service Provider Social Media Handle (Optional, e.g., @CityofJoburgZA on X):</label>
                    <input type="text" id="provider-social" data-i18n="[placeholder]community_tools.incident_report.provider_social_placeholder" placeholder="Enter X handle (auto-filled if provider selected)..." class="w-full p-2 border border-gray-300 rounded text-sm">
                </div>
                <div class="form-group">
                    <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="community_tools.incident_report.employee_route_label">Route to Employer (For Members Only):</label>
                    <select id="employee-route" class="w-full p-2 border border-gray-300 rounded text-sm">
                        <option value="none" data-i18n="community_tools.incident_report.option_none">Do Not Route</option>
                        <option value="supervisor" data-i18n="community_tools.incident_report.option_supervisor">Supervisor</option>
                        <option value="safety_rep" data-i18n="community_tools.incident_report.option_safety_rep">Health and Safety Representative</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="block text-sm font-medium text-gray-700 mb-1" data-i18n="community_tools.incident_report.share_method_label">Share Report Via:</label>
                    <div class="space-y-2">
                        <div class="flex items-center">
                            <input type="checkbox" id="share-email" class="h-4 w-4 text-blue-500 border-gray-300 rounded focus:ring-blue-500">
                            <label for="share-email" class="ml-2 text-sm text-gray-600" data-i18n="community_tools.incident_report.share_email">Email</label>
                        </div>
                        <div class="flex items-center">
                            <input type="checkbox" id="share-sms" class="h-4 w-4 text-blue-500 border-gray-300 rounded focus:ring-blue-500">
                            <label for="share-sms" class="ml-2 text-sm text-gray-600" data-i18n="community_tools.incident_report.share_sms">SMS</label>
                        </div>
                        <div class="flex items-center">
                            <input type="checkbox" id="share-whatsapp" class="h-4 w-4 text-blue-500 border-gray-300 rounded focus:ring-blue-500">
                            <label for="share-whatsapp" class="ml-2 text-sm text-gray-600" data-i18n="community_tools.incident_report.share_whatsapp">WhatsApp</label>
                        </div>
                        <div class="flex items-center">
                            <input type="checkbox" id="share-x" class="h-4 w-4 text-blue-500 border-gray-300 rounded focus:ring-blue-500">
                            <label for="share-x" class="ml-2 text-sm text-gray-600" data-i18n="community_tools.incident_report.share_x">X (Social Media)</label>
                        </div>
                    </div>
                </div>
                <button type="submit" data-i18n="community_tools.incident_report.submit" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Submit Report</button>
            </form>
        </section>

        <section class="tools-list">
            <h3 data-i18n="community_tools.list.title">Other Community Safety Tools</h3>
            <div class="tools-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <div class="tool bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow">
                    <h4 class="text-lg font-semibold text-gray-700 mb-2" data-i18n="community_tools.list.spaza_shop.title">Spaza Shop OHS Checklist</h4>
                    <p class="text-sm text-gray-600 mb-3" data-i18n="community_tools.list.spaza_shop.description">Ensure your spaza shop meets fire safety, electrical, and structural requirements per municipal bylaws and the OHS Act.</p>
                    <button onclick="viewTool('spaza-shop')" data-i18n="community_tools.list.view" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm">View Checklist</button>
                </div>
                <div class="tool bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow">
                    <h4 class="text-lg font-semibold text-gray-700 mb-2" data-i18n="community_tools.list.school.title">School Fire Safety Guide</h4>
                    <p class="text-sm text-gray-600 mb-3" data-i18n="community_tools.list.school.description">Learn the legal requirements for fire safety in schools, including evacuation plans and equipment.</p>
                    <button onclick="viewTool('school')" data-i18n="community_tools.list.view" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm">View Guide</button>
                </div>
                <div class="tool bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow">
                    <h4 class="text-lg font-semibold text-gray-700 mb-2" data-i18n="community_tools.list.hospital.title">Hospital Emergency Preparedness Guide</h4>
                    <p class="text-sm text-gray-600 mb-3" data-i18n="community_tools.list.hospital.description">Ensure hospitals are prepared for emergencies with proper evacuation plans and safety equipment.</p>
                    <button onclick="viewTool('hospital')" data-i18n="community_tools.list.view" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm">View Guide</button>
                </div>
                <div class="tool bg-white border border-gray-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-shadow">
                    <h4 class="text-lg font-semibold text-gray-700 mb-2" data-i18n="community_tools.list.tavern.title">Tavern Safety Checklist</h4>
                    <p class="text-sm text-gray-600 mb-3" data-i18n="community_tools.list.tavern.description">Check that taverns comply with fire safety and crowd management regulations to prevent incidents.</p>
                    <button onclick="viewTool('tavern')" data-i18n="community_tools.list.view" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm">View Checklist</button>
                </div>
            </div>
        </section>
    </div>

    <footer>
        <div class="container mx-auto px-6 text-center">
            <p class="mb-2" data-i18n="footer.copyright">© 2025 SafetyHelp. All rights reserved.</p>
            <p class="mb-4">
                <a href="/safety-plans/privacy.html" data-i18n="footer.links.privacy" class="mx-2">Privacy Policy</a> |
                <a href="/safety-plans/terms.html" data-i18n="footer.links.terms" class="mx-2">Terms of Service</a> |
                <a href="/safety-plans/contact.html" data-i18n="footer.links.contact" class="mx-2">Contact Us</a>
            </p>
            <div class="newsletter mt-6">
                <h3 class="text-lg font-semibold mb-3" data-i18n="footer.newsletter.title">Stay Updated</h3>
                <form class="flex justify-center">
                    <input type="email" data-i18n="[placeholder]footer.newsletter.placeholder" placeholder="Enter your email" aria-label="Email for newsletter" class="px-3 py-2 border border-gray-300 rounded-l text-gray-800 w-64">
                    <button type="submit" data-i18n="footer.newsletter.button" class="px-4 py-2 rounded-r">Subscribe</button>
                </form>
            </div>
        </div>
    </footer>

    <!-- Chatbot Container -->
    <div class="chatbot-container fixed bottom-5 right-5 z-50">
        <button id="chat-toggle" class="chat-toggle-btn p-3 rounded-full shadow-lg flex items-center justify-center bg-orange-500 text-white hover:bg-orange-600 transition duration-300">
            <span class="chat-icon text-2xl mr-1">⛑️</span> 
            <span id="chat-toggle-text" data-i18n="chatbot.button">Ask Salatiso</span>
        </button>
        <div id="chat-window" class="chat-hidden bg-white border border-gray-300 rounded-lg shadow-xl mt-2">
            <div id="chat-output" class="p-3 text-sm h-80 overflow-y-scroll">
                <p><strong>Salatiso:</strong> <span data-i18n="chatbot.welcome">Hello! How can I help you with OHS today?</span></p>
            </div>
            <div id="chat-input-container" class="flex border-t border-gray-200">
                <input id="chat-input" type="text" data-i18n="[placeholder]chatbot.input_placeholder" placeholder="Ask about OHS..." aria-label="Ask about OHS" class="flex-grow p-2 border-none focus:outline-none">
                <button id="chat-send" aria-label="Send message" data-i18n="chatbot.send" class="px-4 py-2 bg-blue-500 text-white hover:bg-blue-600">Send</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script>
        // Translation Initialization with Embedded English Translations
        document.addEventListener('DOMContentLoaded', async () => {
            const translations = {
                "header.nav.home": "Home",
                "header.nav.resources": "Resources",
                "header.nav.services": "Services",
                "header.nav.community": "Community",
                "header.nav.about": "About",
                "header.nav.contact": "Contact",
                "header.nav.login": "Login",
                "header.search.placeholder": "Search OHS Tools...",
                "header.search.button": "Search",
                "language_selector.en": "English",
                "language_selector.af": "Afrikaans",
                "language_selector.zu": "isiZulu",
                "language_selector.xh": "isiXhosa",
                "language_selector.st": "Sesotho",
                "language_selector.tn": "Setswana",
                "language_selector.nso": "Sepedi",
                "language_selector.ts": "Xitsonga",
                "language_selector.ss": "siSwati",
                "language_selector.ve": "Tshivenda",
                "language_selector.nr": "isiNdebele",
                "language_selector.es": "Español",
                "language_selector.fr": "French",
                "language_selector.sn": "Shona",
                "language_selector.sw": "Swahili",
                "language_selector.zh": "Mandarin",
                "sidebar.ohs_tools": "SafetyHelp OHS Tools",
                "sidebar.construction_safety": "Construction Safety",
                "sidebar.emergency_planning": "Emergency Planning",
                "sidebar.risk_assessment": "Risk Assessment",
                "sidebar.legal_appointments": "Legal Appointments",
                "sidebar.incident_management": "Incident Management",
                "sidebar.training": "Training",
                "sidebar.inspections_audits": "Inspections & Audits",
                "sidebar.suppliers": "Suppliers",
                "sidebar.legislation": "Legislation",
                "sidebar.community_tools": "Community Tools",
                "sidebar.member_dashboard": "Member Dashboard",
                "sidebar.ohs_system": "OHS System",
                "sidebar.step_0.title": "📜 Community Safety Tools",
                "sidebar.step_0.description": "Report incidents like potholes or safety hazards and access tools to improve safety in community settings like spaza shops, schools, and hospitals.",
                "sidebar.step_0.fun_fact": "⚡ Did you know timely reporting of community hazards can help prevent accidents and improve public safety?",
                "community_tools.title": "Community Safety Tools",
                "community_tools.description": "Report any safety incident or hazard in your community or workplace, from potholes to defective equipment. Use our tools to ensure safety in settings like spaza shops, schools, hospitals, and taverns.",
                "community_tools.incident_report.title": "Report an Incident or Hazard",
                "community_tools.incident_report.photo_label": "Upload Photo of the Incident (Optional):",
                "community_tools.incident_report.location_info": "Location will be auto-detected...",
                "community_tools.incident_report.weather_info": "Weather will be auto-detected...",
                "community_tools.incident_report.description_label": "Incident Description:",
                "community_tools.incident_report.description_placeholder": "Describe the incident or hazard (e.g., pothole on Main Street, broken chair in community center)...",
                "community_tools.incident_report.user_name_label": "Your Name (Optional):",
                "community_tools.incident_report.user_name_placeholder": "Enter your name...",
                "community_tools.incident_report.user_contact_label": "Your Contact Details (Optional):",
                "community_tools.incident_report.user_contact_placeholder": "Enter your phone or email...",
                "community_tools.incident_report.user_social_label": "Your Social Media Handle (Optional, e.g., @username on X):",
                "community_tools.incident_report.user_social_placeholder": "Enter your X handle...",
                "community_tools.incident_report.service_provider_label": "Service Provider (e.g., Municipality):",
                "community_tools.incident_report.option_select_provider": "Select a Service Provider",
                "community_tools.incident_report.provider_contact_label": "Service Provider Contact Details (Optional):",
                "community_tools.incident_report.provider_contact_placeholder": "Enter phone or email (auto-filled if provider selected)...",
                "community_tools.incident_report.provider_social_label": "Service Provider Social Media Handle (Optional, e.g., @CityofJoburgZA on X):",
                "community_tools.incident_report.provider_social_placeholder": "Enter X handle (auto-filled if provider selected)...",
                "community_tools.incident_report.employee_route_label": "Route to Employer (For Members Only):",
                "community_tools.incident_report.option_none": "Do Not Route",
                "community_tools.incident_report.option_supervisor": "Supervisor",
                "community_tools.incident_report.option_safety_rep": "Health and Safety Representative",
                "community_tools.incident_report.share_method_label": "Share Report Via:",
                "community_tools.incident_report.share_email": "Email",
                "community_tools.incident_report.share_sms": "SMS",
                "community_tools.incident_report.share_whatsapp": "WhatsApp",
                "community_tools.incident_report.share_x": "X (Social Media)",
                "community_tools.incident_report.submit": "Submit Report",
                "community_tools.list.title": "Other Community Safety Tools",
                "community_tools.list.spaza_shop.title": "Spaza Shop OHS Checklist",
                "community_tools.list.spaza_shop.description": "Ensure your spaza shop meets fire safety, electrical, and structural requirements per municipal bylaws and the OHS Act.",
                "community_tools.list.school.title": "School Fire Safety Guide",
                "community_tools.list.school.description": "Learn the legal requirements for fire safety in schools, including evacuation plans and equipment.",
                "community_tools.list.hospital.title": "Hospital Emergency Preparedness Guide",
                "community_tools.list.hospital.description": "Ensure hospitals are prepared for emergencies with proper evacuation plans and safety equipment.",
                "community_tools.list.tavern.title": "Tavern Safety Checklist",
                "community_tools.list.tavern.description": "Check that taverns comply with fire safety and crowd management regulations to prevent incidents.",
                "community_tools.list.view": "View",
                "footer.copyright": "© 2025 SafetyHelp. All rights reserved.",
                "footer.links.privacy": "Privacy Policy",
                "footer.links.terms": "Terms of Service",
                "footer.links.contact": "Contact Us",
                "footer.newsletter.title": "Stay Updated",
                "footer.newsletter.placeholder": "Enter your email",
                "footer.newsletter.button": "Subscribe",
                "chatbot.button": "Ask Salatiso",
                "chatbot.input_placeholder": "Ask about OHS...",
                "chatbot.send": "Send"
            };

            await i18next.init({
                lng: 'en',
                resources: {
                    en: { translation: translations }
                },
                debug: true
            });

            updateContent();

            document.getElementById('language-select').addEventListener('change', (e) => {
                i18next.changeLanguage(e.target.value, (err) => {
                    if (err) {
                        console.error('Error changing language:', err);
                        return;
                    }
                    updateContent();
                });
            });

            function updateContent() {
                document.querySelectorAll('[data-i18n]').forEach(element => {
                    const key = element.getAttribute('data-i18n');
                    if (element.hasAttribute('placeholder')) {
                        element.setAttribute('placeholder', i18next.t(key));
                    } else {
                        element.innerHTML = i18next.t(key);
                    }
                });
            }

            // Google Maps Initialization (Placeholder)
            function initMap() {
                const map = new google.maps.Map(document.getElementById('map'), {
                    center: { lat: -26.2041, lng: 28.0473 }, // Default to Johannesburg, South Africa
                    zoom: 12
                });
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(position => {
                        const pos = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        };
                        map.setCenter(pos);
                        new google.maps.Marker({
                            position: pos,
                            map: map
                        });
                        document.getElementById('location-info').textContent = `Location: ${pos.lat}, ${pos.lng}`;
                    }, () => {
                        document.getElementById('location-info').textContent = 'Location detection failed.';
                    });
                }
            }

            // Form Submission (Placeholder)
            document.getElementById('incident-report-form').addEventListener('submit', (e) => {
                e.preventDefault();
                alert("Incident report submitted! (This is a placeholder action)");
                // Implement actual submission logic in community-tools.js
            });

            // Placeholder Functions
            function updateServiceProviderDetails() {
                console.log("Updating service provider details...");
                // Implement in community-tools.js
            }

            function viewTool(toolId) {
                console.log(`Viewing tool: ${toolId}`);
                // Implement in community-tools.js
            }

            // Chatbot Functionality
    const chatToggle = document.getElementById('chat-toggle');
    const chatWindow = document.getElementById('chat-window');
    const chatOutput = document.getElementById('chat-output');
    const chatInput = document.getElementById('chat-input');
    const chatSend = document.getElementById('chat-send');
    let isExpanded = false;

    chatToggle.addEventListener('click', () => {
        isExpanded = !isExpanded;
        chatWindow.classList.toggle('chat-hidden', !isExpanded);
        chatWindow.classList.toggle('chat-expanded', isExpanded);
        chatToggle.classList.toggle('collapsed', !isExpanded);
        if (isExpanded) {
            chatInput.focus();
        }
    });

    async function sendQuery() {
        if (!db) {
            addChatMessage('Salatiso', 'Sorry, I am currently unavailable.');
            return;
        }
        const input = chatInput.value.trim();
        if (!input) return;
        addChatMessage('You', input);
        chatInput.value = '';
        addChatMessage('Salatiso', 'Searching...');
        const query = input.toLowerCase();

        try {
            const snapshot = await db.collection('ohs-knowledge')
                                     .where('keywords', 'array-contains', query)
                                     .limit(1)
                                     .get();
            let responseFound = false;
            let response = "Sorry, I couldn’t find specific information on that topic. Please try rephrasing or ask a different question.";

            if (!snapshot.empty) {
                snapshot.forEach(doc => {
                    const data = doc.data();
                    response = `Based on information from ${data.book || 'our resources'} (Chapter ${data.chapter || 'N/A'}), here's a summary: <br>${data.content.substring(0, 250)}...`;
                    if (data.file) {
                        response += ` (See <a href="/safety-plans/resources/${data.file}" target="_blank" class="text-blue-500 hover:underline">full chapter</a>)`;
                    }
                    responseFound = true;
                });
            }
            const searchingMessage = chatOutput.querySelector('p:last-child');
            if (searchingMessage && searchingMessage.textContent.includes('Searching...')) {
                searchingMessage.innerHTML = `<strong>Salatiso:</strong> ${response}`;
            } else {
                addChatMessage('Salatiso', response);
            }
        } catch (error) {
            console.error("Firestore query failed:", error);
            const searchingMessage = chatOutput.querySelector('p:last-child');
            if (searchingMessage && searchingMessage.textContent.includes('Searching...')) {
                searchingMessage.innerHTML = `<strong>Salatiso:</strong> Oops, something went wrong while searching. Please try again!`;
            } else {
                addChatMessage('Salatiso', 'Oops, something went wrong while searching. Please try again!');
            }
        }
    }

    function addChatMessage(sender, message) {
        if (chatOutput) {
            const messageElement = document.createElement('p');
            messageElement.classList.add('mb-2');
            messageElement.innerHTML = `<strong>${sender}:</strong> ${message}`;
            chatOutput.appendChild(messageElement);
            chatOutput.scrollTop = chatOutput.scrollHeight;
        }
    }

    chatSend.addEventListener('click', sendQuery);
    chatInput.addEventListener('keypress', (event) => {
        if (event.key === 'Enter') sendQuery();
    });

            // Firebase Initialization (Placeholder - Replace with actual config)
            const firebaseConfig = {
                apiKey: "AIzaSyDASGZnUyav23Mte5Q96H0j-T3LlGzVK-k",
                authDomain: "safetyfirst2025-aea34.firebaseapp.com",
                projectId: "safetyfirst2025-aea34",
                storageBucket: "safetyfirst2025-aea34.firebasestorage.app",
                messagingSenderId: "620306944192",
                appId: "1:620306944192:web:ddadeef6825901068a9d25",
                measurementId: "G-VQL1FCD8NN"
            };
            firebase.initializeApp(firebaseConfig);
            const db = firebase.firestore();
        });
    </script>

    <style>
        /* Intro Section */
        .intro {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-bottom: 24px;
        }
        .intro h2 {
            font-size: 24px;
            color: #333;
            margin-bottom: 10px;
        }
        .intro p {
            font-size: 14px;
            color: #666;
            margin-bottom: 15px;
        }
        .intro a {
            color: #007BFF;
            text-decoration: none;
        }
        .intro a:hover {
            text-decoration: underline;
        }
        /* Incident Report Section */
        .incident-report {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-bottom: 24px;
        }
        .incident-report h3 {
            font-size: 20px;
            color: #333;
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            color: #374151;
            margin-bottom: 5px;
        }
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            font-size: 14px;
        }
        .form-group input[type="checkbox"] {
            width: auto;
            margin-right: 5px;
        }
        /* Tools List Section */
        .tools-list {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-bottom: 24px;
        }
        .tools-list h3 {
            font-size: 20px;
            color: #333;
            margin-bottom: 15px;
        }
        .tools-grid {
            display: grid;
            gap: 16px;
        }
        .tool {
            background-color: white;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: box-shadow 0.3s;
        }
        .tool:hover {
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        .tool h4 {
            font-size: 18px;
            color: #333;
            margin-bottom: 10px;
        }
        .tool p {
            font-size: 14px;
            color: #666;
            margin-bottom: 15px;
        }
        /* Footer */
        footer {
            background-color: #007BFF;
            color: white;
            padding: 15px;
            text-align: center;
            width: 100%;
            margin-top: auto;
        }
        footer p {
            font-size: 14px;
            margin: 5px 0;
        }
        footer a {
            color: #FD7E14;
            text-decoration: none;
        }
        footer a:hover {
            color: #e06b00;
        }
        .newsletter h3 {
            font-size: 14px;
            margin-bottom: 8px;
        }
        .newsletter input {
            padding: 8px;
            border: none;
            border-radius: 2px;
            margin-right: 10px;
            font-size: 14px;
            width: 150px;
        }
        .newsletter button {
            padding: 8px 16px;
            background-color: #FD7E14;
            color: white;
            border: none;
            border-radius: 2px;
            cursor: pointer;
            font-size: 14px;
        }
        .newsletter button:hover {
            background-color: #e06b00;
        }
        /* Chatbot */
        .chatbot-container {
            position: fixed;
            bottom: 1.25rem;
            right: 1.25rem;
            z-index: 1000;
        }
        #chat-window {
            width: 300px;
            max-height: 400px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }
        .chat-hidden {
            display: none;
        }
        #chat-output {
            flex-grow: 1;
        }
        #chat-input-container {
            display: flex;
            border-top-width: 1px;
        }
        #chat-input {
            flex-grow: 1;
            border: none;
            padding: 0.5rem;
        }
        #chat-send {
            border: none;
            padding: 0.5rem 1rem;
            cursor: pointer;
            background-color: #007BFF;
            color: white;
        }
        #chat-send:hover {
            background-color: #0056b3;
        }
        .chat-toggle-btn {
            background-color: #FD7E14;
        }
        .chat-toggle-btn:hover {
            background-color: #e06b00;
        }
        /* Responsive adjustments */
        @media (max-width: 768px) {
            body {
                padding-top: 0;
                flex-direction: column;
            }
            header {
                position: relative;
            }
            .header-container {
                flex-direction: column;
                align-items: center;
            }
            .header-left {
                align-items: center;
                margin-bottom: 10px;
            }
            .nav-links {
                margin: 10px 0;
            }
            .nav-links a {
                margin: 5px 10px;
            }
            .header-right {
                align-items: center;
            }
            .sidebar {
                position: relative;
                top: 0;
                width: 100%;
                height: auto;
                bottom: auto;
                z-index: 1;
            }
            .sidebar h2 {
                text-align: center;
            }
            .main-content {
                margin-left: 0;
                flex-direction: column;
            }
            .intro, .incident-report, .tools-list {
                margin: 1rem;
            }
            .tools-grid {
                grid-template-columns: 1fr;
            }
        }
        /* Chatbot */
    .chatbot-container {
        position: fixed;
        bottom: 1.25rem;
        right: 1.25rem;
        z-index: 1000;
    }
    #chat-window {
        width: 300px;
        max-height: 400px;
        overflow-y: auto;
        display: flex;
        flex-direction: column;
        transition: all 0.3s ease;
    }
    .chat-hidden {
        display: none;
    }
    .chat-expanded {
        display: flex;
    }
    #chat-output {
        flex-grow: 1;
    }
    #chat-input-container {
        display: flex;
        border-top-width: 1px;
    }
    #chat-input {
        flex-grow: 1;
        border: none;
        padding: 0.5rem;
    }
    #chat-send {
        border: none;
        padding: 0.5rem 1rem;
        cursor: pointer;
        background-color: #007BFF;
        color: white;
    }
    #chat-send:hover {
        background-color: #0056b3;
    }
    .chat-toggle-btn {
        background-color: #FD7E14;
    }
    .chat-toggle-btn:hover {
        background-color: #e06b00;
    }
    .chat-toggle-btn.collapsed {
        padding: 0.75rem;
        font-size: 0.875rem;
    }
    .chat-toggle-btn.collapsed #chat-toggle-text {
        display: none;
    }
    </style>
</body>
</html>
