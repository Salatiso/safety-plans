<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Automate construction compliance with Safety First OHS Tools. Generate H&S Specifications, Risk Assessments, and Plans.">
    <meta name="keywords" content="construction compliance, OHS South Africa, health and safety plan, risk assessment">
    <meta name="author" content="Salatiso Lonwabo Mdeni">
    <title>Safety First OHS Tools | Construction Compliance</title>
    <link rel="stylesheet" href="../assets/css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <style>
        .tool-container { max-width: 800px; margin: 20px auto; text-align: center; }
        .role-buttons button { padding: 10px 20px; margin: 10px; font-size: 16px; cursor: pointer; }
        .form-section { display: none; margin-top: 20px; }
        .form-section.active { display: block; }
        .risk-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .risk-table th, .risk-table td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        .output { margin-top: 20px; }
    </style>
</head>
<body>
    <!-- Sidebar (Copied from index.html) -->
    <div class="sidebar">
        <button class="sidebar-trigger" aria-label="Toggle OHS Tools Menu">Tools</button>
        <div class="sidebar-content">
            <h3>OHS Tools</h3>
            <div class="tool-category">
                <button class="category-toggle">Compliance Tools</button>
                <div class="category-content">
                    <a href="construction-compliance.html"><span class="icon">üèóÔ∏è</span> Construction Compliance</a>
                </div>
            </div>
            <!-- Other categories omitted for brevity -->
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <header>
            <h1>Safety First OHS Tools</h1>
            <nav>
                <a href="../index.html">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <div class="search-bar">
                    <form role="search">
                        <input type="text" placeholder="Search OHS Tools..." aria-label="Search OHS Tools">
                        <button type="submit" aria-label="Search">Search</button>
                    </form>
                </div>
            </nav>
        </header>

        <section class="intro">
            <h2>Construction Compliance Tool</h2>
            <p>Automate your compliance with South African Construction Regulations. Select your role below to begin.</p>
        </section>

        <section class="content tool-container">
            <div class="role-buttons">
                <button id="client-btn">I am a Client</button>
                <button id="contractor-btn">I am a Contractor</button>
            </div>

            <!-- Client Form -->
            <div id="client-form" class="form-section">
                <h3>Client Input</h3>
                <form id="client-input">
                    <label>Project Name: <input type="text" name="project-name" required></label><br>
                    <label>Location: <input type="text" name="location" required></label><br>
                    <label>Description: <textarea name="description" required></textarea></label><br>
                    <label>Duration (days): <input type="number" name="duration" required></label><br>
                    <label>Value (ZAR): <input type="number" name="value" required></label><br>
                    <label>Scope: <textarea name="scope" required></textarea></label><br>
                    <button type="submit">Generate Documents</button>
                </form>
                <div id="client-output" class="output"></div>
            </div>

            <!-- Contractor Form -->
            <div id="contractor-form" class="form-section">
                <h3>Contractor Input</h3>
                <form id="contractor-input">
                    <label>Contractor Name: <input type="text" name="contractor-name" required></label><br>
                    <label>COID Number: <input type="text" name="coid-number" required></label><br>
                    <label>H&S Specifications: <input type="file" name="hs-specs" accept=".pdf,.docx"></label><br>
                    <label>Site Activities: <textarea name="activities" required></textarea></label><br>
                    <label>Employee Count: <input type="number" name="employee-count" required></label><br>
                    <h4>Risk Assessment</h4>
                    <table class="risk-table">
                        <thead>
                            <tr><th>Activity</th><th>Hazard</th><th>Health Effect</th><th>Controls</th><th>Risk Rating</th></tr>
                        </thead>
                        <tbody id="risk-table-body">
                            <!-- Pre-populated risks added via JS -->
                        </tbody>
                    </table>
                    <button type="button" id="add-risk">Add Custom Risk</button>
                    <button type="submit">Generate Documents</button>
                </form>
                <div id="contractor-output" class="output"></div>
            </div>
        </section>

        <footer>
            <p>¬© 2025 Safety First OHS Tools. All rights reserved.</p>
            <p><a href="../privacy.html">Privacy Policy</a> | <a href="../terms.html">Terms of Service</a> | <a href="../contact.html">Contact Us</a></p>
        </footer>
    </div>

    <!-- JavaScript -->
    <script>
        // Sidebar functionality (from index.html)
        document.querySelector('.sidebar-trigger').addEventListener('click', function() {
            document.querySelector('.sidebar').classList.toggle('active');
        });
        document.querySelectorAll('.category-toggle').forEach(button => {
            button.addEventListener('click', function() {
                const content = this.nextElementSibling;
                content.classList.toggle('active');
                this.classList.toggle('active');
            });
        });

        // Role selection
        document.getElementById('client-btn').addEventListener('click', () => {
            document.getElementById('client-form').classList.add('active');
            document.getElementById('contractor-form').classList.remove('active');
        });
        document.getElementById('contractor-btn').addEventListener('click', () => {
            document.getElementById('contractor-form').classList.add('active');
            document.getElementById('client-form').classList.remove('active');
        });

        // Pre-populated risks
        const risks = [
            { activity: "Painting", hazard: "Dust from sanding", effect: "Respiratory condition", controls: "RPE, Medical Exam", rating: "M" },
            { activity: "Painting", hazard: "Working at heights", effect: "Fall, Injury", controls: "Scaffolding, PPE", rating: "M-H" },
            { activity: "Excavation", hazard: "Trench collapse", effect: "Crushing injuries", controls: "Shoring, Inspections", rating: "H" },
            // Add more from expanded list above
        ];

        // Populate risk table
        const riskTableBody = document.getElementById('risk-table-body');
        risks.forEach(risk => {
            const row = document.createElement('tr');
            row.innerHTML = `<td>${risk.activity}</td><td>${risk.hazard}</td><td>${risk.effect}</td><td>${risk.controls}</td><td>${risk.rating}</td>`;
            riskTableBody.appendChild(row);
        });

        // Add custom risk
        document.getElementById('add-risk').addEventListener('click', () => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td><input type="text" name="activity"></td>
                <td><input type="text" name="hazard"></td>
                <td><input type="text" name="effect"></td>
                <td><input type="text" name="controls"></td>
                <td><input type="text" name="rating"></td>
            `;
            riskTableBody.appendChild(row);
        });

        // Client form submission
        document.getElementById('client-input').addEventListener('submit', (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData);
            const permitRequired = data.duration > 180 || data.value > 500000; // Simplified logic
            let output = `<h4>Generated Documents</h4>`;
            if (permitRequired) {
                output += `<p><strong>Notification of Construction Work</strong>: Required (Duration: ${data.duration} days, Value: R${data.value})</p>`;
            }
            output += `<p><strong>Baseline Risk Assessment</strong>: Generated for ${data.scope}</p>`;
            output += `<p><strong>H&S Specifications</strong>: Prepared for ${data.projectName}</p>`;
            document.getElementById('client-output').innerHTML = output;
        });

        // Contractor form submission
        document.getElementById('contractor-input').addEventListener('submit', (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData);
            const customRisks = Array.from(riskTableBody.querySelectorAll('tr')).map(row => ({
                activity: row.cells[0].querySelector('input')?.value || row.cells[0].textContent,
                hazard: row.cells[1].querySelector('input')?.value || row.cells[1].textContent,
                effect: row.cells[2].querySelector('input')?.value || row.cells[2].textContent,
                controls: row.cells[3].querySelector('input')?.value || row.cells[3].textContent,
                rating: row.cells[4].querySelector('input')?.value || row.cells[4].textContent,
            }));
            let output = `<h4>Generated Documents</h4>`;
            output += `<p><strong>Detailed Risk Assessment</strong>: Includes ${customRisks.length} risks for ${data.activities}</p>`;
            output += `<p><strong>H&S Plan</strong>: Aligned with COID #${data.coidNumber} and Client Specs</p>`;
            document.getElementById('contractor-output').innerHTML = output;
        });

        // Dynamic header adjustment (from index.html)
        window.addEventListener('load', adjustLayout);
        window.addEventListener('resize', adjustLayout);
        function adjustLayout() {
            const headerHeight = document.querySelector('header').offsetHeight;
            document.querySelector('.main-content').style.paddingTop = headerHeight + 'px';
            document.querySelector('.sidebar').style.top = headerHeight + 'px';
            document.querySelector('.sidebar').style.height = `calc(100% - ${headerHeight}px)`;
        }
    </script>
</body>
</html>
