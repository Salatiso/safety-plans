<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Automate construction compliance with Safety First OHS Tools. Generate H&S Specifications and Plans.">
    <meta name="keywords" content="construction compliance, OHS South Africa, health and safety plan">
    <meta name="author" content="Salatiso Lonwabo Mdeni">
    <title>Safety First OHS Tools | Construction Compliance</title>
    <link rel="stylesheet" href="../assets/css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        .tool-container { max-width: 900px; margin: 20px auto; text-align: center; }
        .intro-boxes { display: flex; justify-content: space-between; margin: 20px 0; }
        .intro-box { width: 45%; padding: 15px; border: 1px solid #ddd; background-color: #f9f9f9; }
        .role-prompt { margin: 20px 0; }
        .role-buttons button { padding: 10px 20px; margin: 10px; font-size: 16px; cursor: pointer; background-color: #007bff; color: white; border: none; }
        .form-section { display: none; margin-top: 20px; }
        .form-section.active { display: block; }
        .form-section label { display: block; margin: 10px 0; text-align: left; }
        .form-section input, .form-section textarea { width: 100%; max-width: 400px; padding: 5px; }
        .output { margin-top: 20px; }
        .download-btn { padding: 8px 16px; margin: 5px; background-color: #28a745; color: white; border: none; cursor: pointer; }
    </style>
</head>
<body>
    <div class="sidebar">
        <button class="sidebar-trigger" aria-label="Toggle OHS Tools Menu">Tools</button>
        <div class="sidebar-content">
            <h3>OHS Tools</h3>
            <div class="tool-category">
                <button class="category-toggle">Compliance Tools</button>
                <div class="category-content">
                    <a href="pages/construction-compliance.html"><span class="icon">üèóÔ∏è</span> Construction Compliance</a>
                    <a href="pages/risk-assessment.html"><span class="icon">‚ö†Ô∏è</span> Risk Assessment</a>
                </div>
            </div>
        </div>
    </div>

    <div class="main-content">
        <header>
            <h1>Safety First OHS Tools</h1>
            <nav>
                <a href="../index.html">Home</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
                <div class="search-bar">
                    <form role="search">
                        <input type="text" placeholder="Search OHS Tools..." aria-label="Search OHS Tools">
                        <button type="submit" aria-label="Search">Search</button>
                    </form>
                </div>
            </nav>
        </header>

        <section class="intro">
            <h2>Construction Compliance Tool</h2>
            <div class="intro-boxes">
                <div class="intro-box">
                    <h3>Client Duties</h3>
                    <p>Per Construction Regulations 2014 (Reg 5):<br>
                    - Appoint competent contractors and agents.<br>
                    - Prepare baseline risk assessments.<br>
                    - Develop H&S specifications.<br>
                    - Notify the Dept. of Labour if required.</p>
                </div>
                <div class="intro-box">
                    <h3>Contractor Duties</h3>
                    <p>Per Construction Regulations 2014 (Reg 7):<br>
                    - Develop an H&S plan based on client specs.<br>
                    - Register with COID.<br>
                    - Appoint safety officers.<br>
                    - Ensure training and compliance.</p>
                </div>
            </div>
            <div class="role-prompt">
                <p>Please select your role to proceed:</p>
                <div class="role-buttons">
                    <button id="client-btn">I am a Client</button>
                    <button id="contractor-btn">I am a Contractor</button>
                </div>
            </div>
        </section>

        <section class="content tool-container">
            <!-- Client Form -->
            <div id="client-form" class="form-section">
                <h3>Client Input</h3>
                <form id="client-input">
                    <label>Project Name: <input type="text" name="project-name" required></label>
                    <label>Location: <input type="text" name="location" required></label>
                    <label>Description: <textarea name="description" required></textarea></label>
                    <label>Duration (days): <input type="number" name="duration" required></label>
                    <label>Person-Days: <input type="number" name="person-days" required></label>
                    <label>Value (ZAR): <input type="number" name="value" required></label>
                    <label>Scope: <textarea name="scope" required></textarea></label>
                    <label>Complex Design (Y/N): <input type="checkbox" name="complex-design"></label>
                    <button type="submit">Generate Documents</button>
                </form>
                <div id="client-output" class="output"></div>
            </div>

            <!-- Contractor Form -->
            <div id="contractor-form" class="form-section">
                <h3>Contractor Input</h3>
                <form id="contractor-input">
                    <label>Contractor Name: <input type="text" name="contractor-name" required></label>
                    <label>COID Number: <input type="text" name="coid-number" required></label>
                    <label>Letter of Good Standing: <input type="file" name="coid-letter" accept=".pdf,.docx"></label>
                    <label>H&S Specifications: <input type="file" name="hs-specs" accept=".pdf,.docx" required></label>
                    <label>Site Activities: <textarea name="activities" required></textarea></label>
                    <label>Employee Count: <input type="number" name="employee-count" required></label>
                    <button type="submit">Generate Documents</button>
                </form>
                <div id="contractor-output" class="output"></div>
            </div>
        </section>

        <footer>
            <p>¬© 2025 Safety First OHS Tools. All rights reserved.</p>
            <p><a href="../privacy.html">Privacy Policy</a> | <a href="../terms.html">Terms of Service</a> | <a href="../contact.html">Contact Us</a></p>
        </footer>
    </div>

    <script>
        const { jsPDF } = window.jspdf;

        // Sidebar functionality
        document.querySelector('.sidebar-trigger').addEventListener('click', function() {
            document.querySelector('.sidebar').classList.toggle('active');
            document.querySelector('.sidebar-content').classList.toggle('active');
        });
        document.querySelectorAll('.category-toggle').forEach(button => {
            button.addEventListener('click', function() {
                const content = this.nextElementSibling;
                content.classList.toggle('active');
                this.classList.toggle('active');
            });
        });

        // Role selection
        document.getElementById('client-btn').addEventListener('click', () => {
            document.getElementById('client-form').classList.add('active');
            document.getElementById('contractor-form').classList.remove('active');
        });
        document.getElementById('contractor-btn').addEventListener('click', () => {
            document.getElementById('contractor-form').classList.add('active');
            document.getElementById('client-form').classList.remove('active');
        });

        // Client form submission
        document.getElementById('client-input').addEventListener('submit', (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData);
            const permitRequired = data.duration > 180 || data['person-days'] > 500 || data.value > 500000;
            const agentRequired = data['complex-design'] === 'on';

            const output = document.getElementById('client-output');
            output.innerHTML = '<h4>Generated Documents</h4>';

            if (permitRequired) {
                const notificationDoc = new jsPDF();
                notificationDoc.text(`Notification of Construction Work\nProject: ${data['project-name']}\nLocation: ${data.location}\nDuration: ${data.duration} days\nPerson-Days: ${data['person-days']}`, 10, 10);
                output.innerHTML += '<button class="download-btn" onclick="downloadPDF(\'notification.pdf\', notificationDoc)">Download Notification</button>';
            }

            const specsDoc = new jsPDF();
            specsDoc.text(`Health and Safety Specifications\nProject: ${data['project-name']}\nLocation: ${data.location}\nScope: ${data.scope}\nRequirements: Comply with OHSA and Construction Regs`, 10, 10);
            output.innerHTML += '<button class="download-btn" onclick="downloadPDF(\'hs-specifications.pdf\', specsDoc)">Download H&S Specs</button>';

            if (agentRequired) {
                const agentDoc = new jsPDF();
                agentDoc.text(`Agent Appointment Letter\nProject: ${data['project-name']}\nAppointed to oversee complex design compliance per Reg 4(1).`, 10, 10);
                output.innerHTML += '<button class="download-btn" onclick="downloadPDF(\'agent-appointment.pdf\', agentDoc)">Download Agent Appointment</button>';
            }
        });

        // Contractor form submission
        document.getElementById('contractor-input').addEventListener('submit', (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData);

            const output = document.getElementById('contractor-output');
            output.innerHTML = '<h4>Generated Documents</h4>';

            const planDoc = new jsPDF();
            planDoc.text(`Health and Safety Plan\nContractor: ${data['contractor-name']}\nCOID: ${data['coid-number']}`, 10, 10);
            planDoc.text(`Purpose: Ensure compliance with OHSA, Construction Regs, and Client Specs`, 10, 20);
            planDoc.text(`Activities: ${data.activities}\nEmployees: ${data['employee-count']}`, 10, 30);
            planDoc.text('Key Controls:\n- Induction training\n- Risk elimination\n- Emergency planning', 10, 50);
            output.innerHTML += '<button class="download-btn" onclick="downloadPDF(\'hs-plan.pdf\', planDoc)">Download H&S Plan</button>';
        });

        // PDF Download Helper
        function downloadPDF(filename, doc) {
            doc.save(filename);
        }

        // Dynamic header adjustment
        window.addEventListener('load', adjustLayout);
        window.addEventListener('resize', adjustLayout);
        function adjustLayout() {
            const headerHeight = document.querySelector('header').offsetHeight;
            document.querySelector('.main-content').style.paddingTop = headerHeight + 'px';
            document.querySelector('.sidebar').style.top = headerHeight + 'px';
            document.querySelector('.sidebar').style.height = `calc(100% - ${headerHeight}px)`;
        }
    </script>
</body>
</html>
