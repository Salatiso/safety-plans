<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Develop tailored emergency response plans with SafetyHelp to ensure safety and compliance with South African OHS regulations. Use our wizard for personalized recommendations or select manually.">
    <meta name="keywords" content="OHS tools, occupational health and safety, emergency response, South Africa OHS, SafetyHelp">
    <meta name="author" content="SafetyHelp Team">
    <title data-i18n="page_title.emergency_response">SafetyHelp - Emergency Response Planning</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/i18next@23.15.2/dist/umd/i18next.min.js"></script>
    <script src="https://unpkg.com/i18next-browser-languagedetector@8.0.0/dist/i18nextBrowserLanguageDetector.min.js"></script>
    <style>
        /* Global Styles */
        body {
            font-family: 'Open Sans', sans-serif;
            background-color: #E8F0FE;
            color: #333;
            margin: 0;
            padding-top: 100px;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        header h1, .sidebar h2, .sidebar h3, .intro h2, .select-method h2, .module-actions h2, .cart-checkout h2, footer h3, .carousel-item h4, .modal-content h4 {
            font-family: 'Montserrat', sans-serif;
        }
        /* Header */
        header {
            background-color: #007BFF;
            color: white;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 50;
            width: 100%;
        }
        .header-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
        }
        .header-left {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        .search-language-container {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        .search-bar button {
            background-color: #FD7E14;
            color: white;
        }
        .search-bar button:hover {
            background-color: #e06b00;
        }
        .language-selector {
            margin-bottom: 5px;
        }
        .language-selector select {
            padding: 4px;
            border-radius: 4px;
            font-size: 14px;
        }
        .nav-links {
            text-align: center;
            flex: 1;
        }
        .nav-links a {
            color: white;
            margin: 0 15px;
            font-family: 'Montserrat', sans-serif;
            text-decoration: none;
        }
        .nav-links a:hover {
            color: #FD7E14;
        }
        .header-right {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
        }
        .logo-container img {
            height: 50px;
        }
        .tagline {
            font-size: 14px;
            margin-top: 5px;
        }
        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 100px;
            left: 0;
            bottom: 0;
            width: 250px;
            background-color: #F4F4F4;
            overflow-y: auto;
            z-index: 40;
            padding: 15px;
        }
        .sidebar h2 {
            color: #007BFF;
            font-size: 24px;
            margin-bottom: 15px;
            text-align: right;
        }
        .sidebar a {
            color: white;
            background-color: #007BFF;
            padding: 8px;
            border-radius: 4px;
            margin-bottom: 5px;
            display: block;
            text-decoration: none;
            font-size: 14px;
            transition: font-weight 0.3s;
        }
        .sidebar a:hover {
            font-weight: bold;
            background-color: #0056b3;
        }
        .sidebar a.active {
            background-color: #28A745;
        }
        .step-info {
            background-color: #E8F0FE;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
        }
        .step-info h3 {
            font-size: 18px;
            color: #007BFF;
            margin-bottom: 10px;
        }
        .step-info p {
            font-size: 14px;
        }
        .fun-fact {
            color: #28A745;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container mx-auto header-container">
            <div class="header-left">
                <div class="logo-container">
                    <img src="/safety-plans/assets/images/logo.png" alt="SafetyHelp Logo">
                    <p class="tagline" data-i18n="header.tagline">Safety Personalized, Compliance Simplified‚ÄîAnytime, Anywhere</p>
                </div>
            </div>
            <div class="nav-links">
                <a href="/safety-plans/index.html" data-i18n="header.nav.home">Home</a>
                <a href="/safety-plans/resources.html" data-i18n="header.nav.resources">Resources</a>
                <a href="/safety-plans/services.html" data-i18n="header.nav.services">Services</a>
                <a href="/safety-plans/community.html" data-i18n="header.nav.community">Community</a>
                <a href="/safety-plans/about.html" data-i18n="header.nav.about">About</a>
                <a href="/safety-plans/contact.html" data-i18n="header.nav.contact">Contact</a>
                <a href="/safety-plans/login.html" id="login-link" data-i18n="header.nav.login">Login</a>
            </div>
            <div class="header-right">
                <div class="search-language-container">
                    <div class="language-selector">
                        <select id="language-select" aria-label="Select language">
                            <option value="en" data-i18n="language_selector.en">English</option>
                            <option value="af" data-i18n="language_selector.af">Afrikaans</option>
                            <option value="zu" data-i18n="language_selector.zu">isiZulu</option>
                            <option value="xh" data-i18n="language_selector.xh">isiXhosa</option>
                            <option value="st" data-i18n="language_selector.st">Sesotho</option>
                            <option value="tn" data-i18n="language_selector.tn">Setswana</option>
                            <option value="nso" data-i18n="language_selector.nso">Sepedi</option>
                            <option value="ts" data-i18n="language_selector.ts">Xitsonga</option>
                            <option value="ss" data-i18n="language_selector.ss">siSwati</option>
                            <option value="ve" data-i18n="language_selector.ve">Tshivenda</option>
                            <option value="nr" data-i18n="language_selector.nr">isiNdebele</option>
                            <option value="es" data-i18n="language_selector.es">Espa√±ol</option>
                            <option value="fr" data-i18n="language_selector.fr">French</option>
                            <option value="sn" data-i18n="language_selector.sn">Shona</option>
                            <option value="sw" data-i18n="language_selector.sw">Swahili</option>
                            <option value="zh" data-i18n="language_selector.zh">Mandarin</option>
                        </select>
                    </div>
                    <div class="search-bar">
                        <form role="search" class="flex">
                            <input type="text" data-i18n="[placeholder]header.search.placeholder" placeholder="Search OHS Tools..." aria-label="Search OHS Tools" class="px-3 py-1 border border-gray-300 rounded-l text-gray-800">
                            <button type="submit" aria-label="Search" data-i18n="header.search.button" class="px-4 py-1 bg-blue-500 hover:bg-blue-600 text-white rounded-r">Search</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Sidebar -->
    <aside class="sidebar">
        <h2 data-i18n="sidebar.ohs_tools">SafetyHelp OHS Tools</h2>
        <ul class="space-y-2">
            <li><a href="/safety-plans/pages/construction-compliance.html" data-i18n="sidebar.construction_safety">Construction Safety</a></li>
            <li><a href="/safety-plans/pages/emergency-response-plan.html" data-i18n="sidebar.emergency_planning" class="active">Emergency Planning</a></li>
            <li><a href="/safety-plans/pages/risk-assessment.html" data-i18n="sidebar.risk_assessment">Risk Assessment</a></li>
            <li><a href="/safety-plans/pages/legal-appointments.html" data-i18n="sidebar.legal_appointments">Legal Appointments</a></li>
            <li><a href="/safety-plans/pages/incident-management.html" data-i18n="sidebar.incident_management">Incident Management</a></li>
            <li><a href="/safety-plans/pages/training.html" data-i18n="sidebar.training">Training</a></li>
            <li><a href="/safety-plans/pages/inspections-audits.html" data-i18n="sidebar.inspections_audits">Inspections & Audits</a></li>
            <li><a href="/safety-plans/pages/suppliers.html" data-i18n="sidebar.suppliers">Suppliers</a></li>
            <li><a href="/safety-plans/pages/legislation.html" data-i18n="sidebar.legislation">Legislation</a></li>
            <li><a href="/safety-plans/pages/community-tools.html" data-i18n="sidebar.community_tools">Community Tools</a></li>
            <li><a href="/safety-plans/pages/member-dashboard.html" data-i18n="sidebar.member_dashboard">Member Dashboard</a></li>
            <li><a href="/safety-plans/pages/ohs-system.html" data-i18n="sidebar.ohs_system">OHS System</a></li>
        </ul>
        <div id="sidebar-step-info" class="step-info">
            <h3 data-i18n="sidebar.step_0.title">üìú Welcome to SafetyHelp</h3>
            <p data-i18n="sidebar.step_0.description" class="text-sm mb-3">Explore our comprehensive tools and resources to enhance occupational health and safety in your workplace.</p>
            <p class="fun-fact text-sm" data-i18n="sidebar.step_0.fun_fact">‚ö° Did you know using reputable ethical suppliers can reduce workplace hazards by ensuring work is done on time and to the highest quality and safety standards?</p>
        </div>
    </aside>

    <!-- Main Content -->
    <div class="main-content">
        <div class="content-column">
            <!-- Introductory Section -->
            <section class="intro">
                <h2 data-i18n="intro.title" class="text-2xl font-bold mb-4">Comprehensive Emergency Response Planning</h2>
                <p data-i18n="intro.description" class="text-gray-600 mb-4">Develop tailored emergency response plans to ensure safety and compliance with South African OHS regulations. Select your planning method manually or use our wizard for personalized recommendations based on your industry, location, and risks.</p>
                <button id="start-planning-btn" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Start Planning Now</button>
            </section>

            <!-- Select Your Method Section -->
            <section id="select-method-section" class="select-method hidden">
                <h2 data-i18n="select_method.title" class="text-2xl font-bold mb-4">Select Your Planning Method</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="method-card bg-gray-50 p-6 rounded-lg shadow hover:shadow-lg transition-shadow duration-300 cursor-pointer" data-method="wizard">
                        <h3 class="text-xl font-semibold text-gray-700 mb-3">Start the Module Wizard</h3>
                        <p class="text-gray-600 text-sm">Answer a few questions to get personalized emergency response recommendations tailored to your needs.</p>
                    </div>
                    <div class="method-card bg-gray-50 p-6 rounded-lg shadow hover:shadow-lg transition-shadow duration-300 cursor-pointer" data-method="category">
                        <h3 class="text-xl font-semibold text-gray-700 mb-3">Select by Category</h3>
                        <p class="text-gray-600 text-sm">Browse emergency response plans by category, such as fire, medical, or chemical spills.</p>
                    </div>
                    <div class="method-card bg-gray-50 p-6 rounded-lg shadow hover:shadow-lg transition-shadow duration-300 cursor-pointer" data-method="manual">
                        <h3 class="text-xl font-semibold text-gray-700 mb-3">Select Manually</h3>
                        <p class="text-gray-600 text-sm">Manually choose from all available emergency response plans and templates.</p>
                    </div>
                </div>
            </section>

            <!-- Wizard Section -->
            <section id="wizard-section" class="wizard hidden">
                <h2 class="text-2xl font-bold mb-4">Emergency Response Planning Wizard</h2>
                <div id="wizard-step-1" class="wizard-step">
                    <h3 class="text-lg font-semibold mb-3">Step 1: Industry and Location</h3>
                    <form id="wizard-form-1">
                        <div class="mb-4">
                            <label for="industry" class="block text-gray-700 mb-2">Industry</label>
                            <select id="industry" name="industry" class="w-full px-3 py-2 border rounded">
                                <option value="">Select Industry</option>
                                <option value="construction">Construction</option>
                                <option value="mining">Mining</option>
                                <option value="manufacturing">Manufacturing</option>
                                <option value="informal_retail">Informal Retail (e.g., Spaza Shops)</option>
                                <option value="education">Education (Schools)</option>
                                <option value="religious">Religious (Churches)</option>
                            </select>
                        </div>
                        <div class="mb-4">
                            <label for="location" class="block text-gray-700 mb-2">Location (Province)</label>
                            <select id="location" name="location" class="w-full px-3 py-2 border rounded">
                                <option value="">Select Province</option>
                                <option value="gauteng">Gauteng</option>
                                <option value="western_cape">Western Cape</option>
                                <option value="kwazulu_natal">KwaZulu-Natal</option>
                                <option value="eastern_cape">Eastern Cape</option>
                                <option value="free_state">Free State</option>
                                <option value="limpopo">Limpopo</option>
                                <option value="mpumalanga">Mpumalanga</option>
                                <option value="north_west">North West</option>
                                <option value="northern_cape">Northern Cape</option>
                            </select>
                        </div>
                        <button type="button" id="wizard-next-1" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Next</button>
                    </form>
                </div>
                <div id="wizard-step-2" class="wizard-step hidden">
                    <h3 class="text-lg font-semibold mb-3">Step 2: Activities and Risks</h3>
                    <form id="wizard-form-2">
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2">Primary Activities (Select all that apply)</label>
                            <div class="space-y-2">
                                <label><input type="checkbox" name="activities" value="heavy_machinery"> Heavy Machinery Use</label><br>
                                <label><input type="checkbox" name="activities" value="chemical_handling"> Chemical Handling</label><br>
                                <label><input type="checkbox" name="activities" value="public_gatherings"> Public Gatherings</label>
                            </div>
                        </div>
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2">Risk Levels</label>
                            <div class="space-y-2">
                                <div>
                                    <label for="fire-risk" class="block text-gray-700">Fire Risk</label>
                                    <input type="range" id="fire-risk" name="fire-risk" min="1" max="3" value="1">
                                    <span id="fire-risk-label" class="text-gray-600">Low</span>
                                </div>
                                <div>
                                    <label for="medical-risk" class="block text-gray-700">Medical Emergency Risk</label>
                                    <input type="range" id="medical-risk" name="medical-risk" min="1" max="3" value="1">
                                    <span id="medical-risk-label" class="text-gray-600">Low</span>
                                </div>
                                <div>
                                    <label for="chemical-risk" class="block text-gray-700">Chemical Spill Risk</label>
                                    <input type="range" id="chemical-risk" name="chemical-risk" min="1" max="3" value="1">
                                    <span id="chemical-risk-label" class="text-gray-600">Low</span>
                                </div>
                            </div>
                        </div>
                        <button type="button" id="wizard-back-2" class="px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 mr-2">Back</button>
                        <button type="button" id="wizard-next-2" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Next</button>
                    </form>
                </div>
                <div id="wizard-step-3" class="wizard-step hidden">
                    <h3 class="text-lg font-semibold mb-3">Step 3: Company Details</h3>
                    <form id="wizard-form-3">
                        <div class="mb-4">
                            <label for="company-size" class="block text-gray-700 mb-2">Company Size (Number of Employees/Members)</label>
                            <select id="company-size" name="company-size" class="w-full px-3 py-2 border rounded">
                                <option value="">Select Size</option>
                                <option value="1-10">1-10</option>
                                <option value="11-50">11-50</option>
                                <option value="50+">50+</option>
                            </select>
                        </div>
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2">Do you have existing safety measures?</label>
                            <label><input type="radio" name="existing-measures" value="yes"> Yes</label>
                            <label class="ml-4"><input type="radio" name="existing-measures" value="no"> No</label>
                        </div>
                        <button type="button" id="wizard-back-3" class="px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 mr-2">Back</button>
                        <button type="button" id="wizard-finish" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Finish</button>
                    </form>
                </div>
                <div id="wizard-recommendations" class="hidden">
                    <h3 class="text-lg font-semibold mb-3">Recommendations</h3>
                    <div id="recommendations-list" class="space-y-4"></div>
                    <button id="proceed-to-actions" class="mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Proceed to Actions</button>
                </div>
            </section>

            <!-- Category Selection Section -->
            <section id="category-section" class="category hidden">
                <h2 class="text-2xl font-bold mb-4">Select by Category</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                    <div class="category-card bg-gray-50 p-4 rounded-lg shadow hover:shadow-lg transition-shadow duration-300 cursor-pointer" data-category="fire">
                        <h3 class="text-lg font-semibold text-gray-700 mb-2">Fire</h3>
                        <p class="text-gray-600 text-sm">Plans and templates for fire-related emergencies.</p>
                    </div>
                    <div class="category-card bg-gray-50 p-4 rounded-lg shadow hover:shadow-lg transition-shadow duration-300 cursor-pointer" data-category="medical">
                        <h3 class="text-lg font-semibold text-gray-700 mb-2">Medical Emergency</h3>
                        <p class="text-gray-600 text-sm">Plans for medical emergencies like injuries.</p>
                    </div>
                    <div class="category-card bg-gray-50 p-4 rounded-lg shadow hover:shadow-lg transition-shadow duration-300 cursor-pointer" data-category="chemical">
                        <h3 class="text-lg font-semibold text-gray-700 mb-2">Chemical Spill</h3>
                        <p class="text-gray-600 text-sm">Plans for handling chemical spills safely.</p>
                    </div>
                    <div class="category-card bg-gray-50 p-4 rounded-lg shadow hover:shadow-lg transition-shadow duration-300 cursor-pointer" data-category="natural">
                        <h3 class="text-lg font-semibold text-gray-700 mb-2">Natural Disaster</h3>
                        <p class="text-gray-600 text-sm">Plans for floods, earthquakes, and more.</p>
                    </div>
                </div>
                <div id="category-options" class="mt-6 hidden">
                    <h3 class="text-lg font-semibold mb-3" id="category-title"></h3>
                    <div id="category-options-list" class="space-y-4"></div>
                    <button id="category-back" class="mt-4 px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 mr-2">Back</button>
                    <button id="category-proceed" class="mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Proceed to Actions</button>
                </div>
            </section>

            <!-- Manual Selection Section -->
            <section id="manual-section" class="manual hidden">
                <h2 class="text-2xl font-bold mb-4">Select Manually</h2>
                <div id="manual-options" class="space-y-4">
                    <div class="manual-option bg-gray-50 p-4 rounded-lg shadow cursor-pointer">
                        <h3 class="text-lg font-semibold text-gray-700 mb-2">Fire Evacuation Plan</h3>
                        <p class="text-gray-600 text-sm">A detailed plan for evacuating during a fire emergency.</p>
                    </div>
                    <div class="manual-option bg-gray-50 p-4 rounded-lg shadow cursor-pointer">
                        <h3 class="text-lg font-semibold text-gray-700 mb-2">Medical Emergency Protocol</h3>
                        <p class="text-gray-600 text-sm">Protocol for handling medical emergencies on-site.</p>
                    </div>
                    <div class="manual-option bg-gray-50 p-4 rounded-lg shadow cursor-pointer">
                        <h3 class="text-lg font-semibold text-gray-700 mb-2">Chemical Spill Response Checklist</h3>
                        <p class="text-gray-600 text-sm">Checklist for safely managing chemical spills.</p>
                    </div>
                    <div class="manual-option bg-gray-50 p-4 rounded-lg shadow cursor-pointer">
                        <h3 class="text-lg font-semibold text-gray-700 mb-2">Flood Response Plan</h3>
                        <p class="text-gray-600 text-sm">Plan for responding to flood emergencies.</p>
                    </div>
                </div>
                <button id="manual-back" class="mt-4 px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 mr-2">Back</button>
                <button id="manual-proceed" class="mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Proceed to Actions</button>
            </section>

            <!-- Module Actions Section -->
            <section id="module-actions-section" class="module-actions hidden">
                <h2 class="text-2xl font-bold mb-4">Emergency Response Planning Actions</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="action-card bg-gray-50 p-6 rounded-lg shadow hover:shadow-lg transition-shadow duration-300 cursor-pointer" data-action="generate-policy">
                        <h3 class="text-xl font-semibold text-gray-700 mb-3">Generate Emergency Response Policy</h3>
                        <p class="text-gray-600 text-sm">Create a customized emergency response policy for your organization.</p>
                    </div>
                    <div class="action-card bg-gray-50 p-6 rounded-lg shadow hover:shadow-lg transition-shadow duration-300 cursor-pointer" data-action="generate-standards">
                        <h3 class="text-xl font-semibold text-gray-700 mb-3">Generate Standards & Templates</h3>
                        <p class="text-gray-600 text-sm">Produce tailored standards and templates for emergency response.</p>
                    </div>
                    <div class="action-card bg-gray-50 p-6 rounded-lg shadow hover:shadow-lg transition-shadow duration-300 cursor-pointer" data-action="create-plan">
                        <h3 class="text-xl font-semibold text-gray-700 mb-3">Create Emergency Response Plan</h3>
                        <p class="text-gray-600 text-sm">Develop a detailed emergency response plan for your workplace.</p>
                    </div>
                    <div class="action-card bg-gray-50 p-6 rounded-lg shadow hover:shadow-lg transition-shadow duration-300 cursor-pointer" data-action="conduct-drill">
                        <h3 class="text-xl font-semibold text-gray-700 mb-3">Conduct Emergency Drill Evaluation</h3>
                        <p class="text-gray-600 text-sm">Evaluate the effectiveness of your emergency drills.</p>
                    </div>
                    <div class="action-card bg-gray-50 p-6 rounded-lg shadow hover:shadow-lg transition-shadow duration-300 cursor-pointer" data-action="maintain-register">
                        <h3 class="text-xl font-semibold text-gray-700 mb-3">Maintain Emergency Register</h3>
                        <p class="text-gray-600 text-sm">Log incidents and drills for compliance.</p>
                    </div>
                </div>
            </section>

            <!-- Generate Policy Section -->
            <section id="generate-policy-section" class="hidden">
                <h2 class="text-2xl font-bold mb-4">Generate Emergency Response Policy</h2>
                <form id="policy-form">
                    <div class="mb-4">
                        <label for="company-name" class="block text-gray-700 mb-2">Company Name</label>
                        <input type="text" id="company-name" name="company-name" class="w-full px-3 py-2 border rounded" placeholder="e.g., ABC Construction">
                    </div>
                    <button type="button" id="generate-policy-btn" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Generate Policy</button>
                    <button type="button" id="policy-back" class="px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 ml-2">Back</button>
                </form>
                <div id="policy-result" class="mt-4 hidden">
                    <p class="text-green-600">Policy generated successfully! Added to cart.</p>
                </div>
            </section>

            <!-- Generate Standards Section -->
            <section id="generate-standards-section" class="hidden">
                <h2 class="text-2xl font-bold mb-4">Generate Standards & Templates</h2>
                <form id="standards-form">
                    <div class="mb-4">
                        <label for="standard-type" class="block text-gray-700 mb-2">Select Standard/Template Type</label>
                        <select id="standard-type" name="standard-type" class="w-full px-3 py-2 border rounded">
                            <option value="">Select Type</option>
                            <option value="fire-standard">Fire Safety Standard</option>
                            <option value="fire-template">Fire Evacuation Template</option>
                            <option value="chemical-template">Chemical Spill Checklist</option>
                        </select>
                    </div>
                    <button type="button" id="generate-standard-btn" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Generate</button>
                    <button type="button" id="standards-back" class="px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 ml-2">Back</button>
                </form>
                <div id="standards-result" class="mt-4 hidden">
                    <p class="text-green-600">Standard/Template generated successfully! Added to cart.</p>
                </div>
            </section>

            <!-- Create Emergency Response Plan Section -->
            <section id="create-plan-section" class="hidden">
                <h2 class="text-2xl font-bold mb-4">Create Emergency Response Plan</h2>
                <div id="plan-step-1" class="plan-step">
                    <h3 class="text-lg font-semibold mb-3">Step 1: Identify Scenarios</h3>
                    <form id="plan-form-1">
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2">Select Applicable Emergencies</label>
                            <div class="space-y-2">
                                <label><input type="checkbox" name="scenarios" value="fire"> Fire</label><br>
                                <label><input type="checkbox" name="scenarios" value="medical"> Medical Emergency</label><br>
                                <label><input type="checkbox" name="scenarios" value="chemical"> Chemical Spill</label>
                            </div>
                        </div>
                        <button type="button" id="plan-next-1" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Next</button>
                        <button type="button" id="plan-back-1" class="px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 ml-2">Back</button>
                    </form>
                </div>
                <div id="plan-step-2" class="plan-step hidden">
                    <h3 class="text-lg font-semibold mb-3">Step 2: Define Roles</h3>
                    <form id="plan-form-2">
                        <div class="mb-4">
                            <label for="evacuation-coordinator" class="block text-gray-700 mb-2">Evacuation Coordinator</label>
                            <input type="text" id="evacuation-coordinator" name="evacuation-coordinator" class="w-full px-3 py-2 border rounded" placeholder="e.g., John Doe">
                        </div>
                        <div class="mb-4">
                            <label for="first-aider" class="block text-gray-700 mb-2">First Aider</label>
                            <input type="text" id="first-aider" name="first-aider" class="w-full px-3 py-2 border rounded" placeholder="e.g., Jane Smith">
                        </div>
                        <button type="button" id="plan-back-2" class="px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 mr-2">Back</button>
                        <button type="button" id="plan-next-2" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Next</button>
                    </form>
                </div>
                <div id="plan-step-3" class="plan-step hidden">
                    <h3 class="text-lg font-semibold mb-3">Step 3: Map Evacuation Routes</h3>
                    <form id="plan-form-3">
                        <div class="mb-4">
                            <label for="exits" class="block text-gray-700 mb-2">Number of Exits</label>
                            <input type="number" id="exits" name="exits" class="w-full px-3 py-2 border rounded" min="1">
                        </div>
                        <div class="mb-4">
                            <label for="assembly-points" class="block text-gray-700 mb-2">Assembly Points</label>
                            <textarea id="assembly-points" name="assembly-points" class="w-full px-3 py-2 border rounded" placeholder="e.g., Main gate, parking lot"></textarea>
                        </div>
                        <button type="button" id="plan-back-3" class="px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 mr-2">Back</button>
                        <button type="button" id="plan-next-3" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Next</button>
                    </form>
                </div>
                <div id="plan-step-4" class="plan-step hidden">
                    <h3 class="text-lg font-semibold mb-3">Step 4: Set Procedures</h3>
                    <form id="plan-form-4">
                        <div class="mb-4">
                            <label for="procedures" class="block text-gray-700 mb-2">Emergency Procedures</label>
                            <textarea id="procedures" name="procedures" class="w-full px-3 py-2 border rounded" placeholder="e.g., Sound the alarm, evacuate to assembly point"></textarea>
                        </div>
                        <button type="button" id="plan-back-4" class="px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 mr-2">Back</button>
                        <button type="button" id="plan-finish" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Finish</button>
                    </form>
                </div>
                <div id="plan-result" class="mt-4 hidden">
                    <p class="text-green-600">Emergency Response Plan created successfully! Added to cart.</p>
                </div>
            </section>

            <!-- Conduct Drill Evaluation Section -->
            <section id="conduct-drill-section" class="hidden">
                <h2 class="text-2xl font-bold mb-4">Conduct Emergency Drill Evaluation</h2>
                <div id="drill-step-1" class="drill-step">
                    <h3 class="text-lg font-semibold mb-3">Step 1: Schedule Drill</h3>
                    <form id="drill-form-1">
                        <div class="mb-4">
                            <label for="drill-date" class="block text-gray-700 mb-2">Drill Date</label>
                            <input type="date" id="drill-date" name="drill-date" class="w-full px-3 py-2 border rounded">
                        </div>
                        <div class="mb-4">
                            <label for="drill-scenario" class="block text-gray-700 mb-2">Scenario</label>
                            <select id="drill-scenario" name="drill-scenario" class="w-full px-3 py-2 border rounded">
                                <option value="">Select Scenario</option>
                                <option value="fire">Fire</option>
                                <option value="medical">Medical Emergency</option>
                                <option value="chemical">Chemical Spill</option>
                            </select>
                        </div>
                        <button type="button" id="drill-next-1" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Next</button>
                        <button type="button" id="drill-back-1" class="px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 ml-2">Back</button>
                    </form>
                </div>
                <div id="drill-step-2" class="drill-step hidden">
                    <h3 class="text-lg font-semibold mb-3">Step 2: Record Participants</h3>
                    <form id="drill-form-2">
                        <div class="mb-4">
                            <label for="participants-count" class="block text-gray-700 mb-2">Number of Participants</label>
                            <input type="number" id="participants-count" name="participants-count" class="w-full px-3 py-2 border rounded" min="1">
                        </div>
                        <div class="mb-4">
                            <label for="participant-roles" class="block text-gray-700 mb-2">Participant Roles</label>
                            <textarea id="participant-roles" name="participant-roles" class="w-full px-3 py-2 border rounded" placeholder="e.g., Evacuation Coordinator: John Doe"></textarea>
                        </div>
                        <button type="button" id="drill-back-2" class="px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 mr-2">Back</button>
                        <button type="button" id="drill-next-2" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Next</button>
                    </form>
                </div>
                <div id="drill-step-3" class="drill-step hidden">
                    <h3 class="text-lg font-semibold mb-3">Step 3: Evaluate Performance</h3>
                    <form id="drill-form-3">
                        <div class="mb-4">
                            <label for="evacuation-time" class="block text-gray-700 mb-2">Evacuation Time (minutes)</label>
                            <input type="number" id="evacuation-time" name="evacuation-time" class="w-full px-3 py-2 border rounded" min="1">
                        </div>
                        <div class="mb-4">
                            <label for="communication-rating" class="block text-gray-700 mb-2">Communication Rating</label>
                            <select id="communication-rating" name="communication-rating" class="w-full px-3 py-2 border rounded">
                                <option value="poor">Poor</option>
                                <option value="good">Good</option>
                                <option value="excellent">Excellent</option>
                            </select>
                        </div>
                        <button type="button" id="drill-back-3" class="px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 mr-2">Back</button>
                        <button type="button" id="drill-finish" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Finish</button>
                    </form>
                </div>
                <div id="drill-result" class="mt-4 hidden">
                    <p class="text-green-600">Drill Evaluation completed successfully! Added to cart.</p>
                </div>
            </section>

            <!-- Maintain Register Section -->
            <section id="maintain-register-section" class="hidden">
                <h2 class="text-2xl font-bold mb-4">Maintain Emergency Register</h2>
                <form id="register-form">
                    <div class="mb-4">
                        <label for="register-type" class="block text-gray-700 mb-2">Entry Type</label>
                        <select id="register-type" name="register-type" class="w-full px-3 py-2 border rounded">
                            <option value="">Select Type</option>
                            <option value="incident">Incident</option>
                            <option value="drill">Drill</option>
                        </select>
                    </div>
                    <div id="register-details" class="hidden">
                        <div class="mb-4">
                            <label for="entry-date" class="block text-gray-700 mb-2">Date</label>
                            <input type="date" id="entry-date" name="entry-date" class="w-full px-3 py-2 border rounded">
                        </div>
                        <div class="mb-4">
                            <label for="entry-details" class="block text-gray-700 mb-2">Details</label>
                            <textarea id="entry-details" name="entry-details" class="w-full px-3 py-2 border rounded" placeholder="e.g., Fire drill conducted, 50 participants"></textarea>
                        </div>
                        <button type="button" id="add-entry-btn" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Add Entry</button>
                    </div>
                    <button type="button" id="register-back" class="px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 ml-2">Back</button>
                </form>
                <div id="register-entries" class="mt-4 space-y-4"></div>
                <button id="download-register-btn" class="mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 hidden">Download Register</button>
            </section>

            <!-- Cart and Checkout Section -->
            <section id="cart-checkout-section" class="cart-checkout hidden">
                <h2 class="text-2xl font-bold mb-4">Cart and Checkout</h2>
                <div id="cart-items" class="space-y-4"></div>
                <p id="cart-total" class="text-lg font-semibold mt-4"></p>
                <button id="checkout-btn" class="mt-4 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">Proceed to Checkout</button>
                <button id="subscribe-btn" class="mt-4 px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 ml-2">Subscribe for Full Access</button>
            </section>
        </div>

        <!-- Carousel Section -->
        <div class="carousel-container">
            <div class="carousel-item active" data-index="0">
                <h4>üåç Prehistoric Era: Early OHS Practices</h4>
                <p>Early humans used communal knowledge to train hunters on safe tool use, minimizing injuries.</p>
            </div>
            <div class="carousel-item" data-index="1">
                <h4>üèπ 3000 BCE: Ancient Egypt OHS</h4>
                <p>Egyptian pyramid builders used ramps to reduce lifting injuries, an early ergonomic practice.</p>
            </div>
            <div class="carousel-item" data-index="2">
                <h4>‚öíÔ∏è 1800 BCE: Babylonian Code of Hammurabi</h4>
                <p>The Code of Hammurabi included laws on workplace accountability, like penalties for builders if structures collapsed.</p>
            </div>
            <div class="carousel-item" data-index="3">
                <h4>ü©∫ 400 BCE: Hippocrates on Lead Poisoning</h4>
                <p>Greek physician Hippocrates described lead poisoning in miners, an early recognition of occupational disease.</p>
            </div>
            <div class="carousel-item" data-index="4">
                <h4>üè∫ 200 BCE: Roman OHS Innovations</h4>
                <p>Romans used aqueducts to reduce worker exposure to contaminated water, improving health on construction sites.</p>
            </div>
            <div class="carousel-item" data-index="5">
                <h4>üåø Pre-1652: Precolonial South Africa OHS</h4>
                <p>Bantu and Khoisan communities used medicinal plants like aloe to treat work-related injuries.</p>
            </div>
            <div class="carousel-item" data-index="6">
                <h4>ü™ì Pre-1652: Task Rotation in South Africa</h4>
                <p>Indigenous South Africans practiced task rotation in agriculture to reduce fatigue and injury risks.</p>
            </div>
            <div class="carousel-item" data-index="7">
                <h4>‚öíÔ∏è 1652: Dutch East India Company in Cape Town</h4>
                <p>The Dutch introduced European trades like carpentry, bringing new workplace hazards to South Africa.</p>
            </div>
            <div class="carousel-item" data-index="8">
                <h4>‚õèÔ∏è 1867: Mineral Revolution in South Africa</h4>
                <p>Diamond discovery in Hopetown led to deep-shaft mining, exposing workers to cave-ins and silica dust.</p>
            </div>
            <div class="carousel-item" data-index="9">
                <h4>ü™® 1871: Kimberley Deep-Shaft Mining Risks</h4>
                <p>Kimberley mines introduced risks like toxic gas exposure, with over 50,000 workers affected by 1875.</p>
            </div>
            <div class="carousel-item" data-index="10">
                <h4>üè≠ 1886: Witwatersrand Gold Rush</h4>
                <p>The gold rush in Johannesburg led to over 1,000 annual fatalities by 1904 due to rockfalls and explosions.</p>
            </div>
            <div class="carousel-item" data-index="11">
                <h4>üõ†Ô∏è 1886: Industrial OHS in South Africa</h4>
                <p>Factories in Cape Town and Johannesburg introduced risks like machinery entanglement and chemical burns.</p>
            </div>
            <div class="carousel-item" data-index="12">
                <h4>üåç 1893: Migrant Labour System in South Africa</h4>
                <p>The Chamber of Mines created a migrant labour system, exposing black workers to hazardous jobs.</p>
            </div>
            <div class="carousel-item" data-index="13">
                <h4>üìú 1911: Mines and Works Act in South Africa</h4>
                <p>South Africa‚Äôs first OHS framework mandated mine inspectors but enforced a ‚Äúcolour bar‚Äù limiting safety roles to white workers.</p>
            </div>
            <div class="carousel-item" data-index="14">
                <h4>ü©∫ 1912: Silicosis Compensation in South Africa</h4>
                <p>Temporary compensation for silicosis was introduced, with over 20% of miners affected by 1920.</p>
            </div>
            <div class="carousel-item" data-index="15">
                <h4>üö® 1932: Safety First Association in South Africa</h4>
                <p>Sir Ernest Oppenheimer founded the Safety First Association to promote accident prevention in mines.</p>
            </div>
            <div class="carousel-item" data-index="16">
                <h4>üåç 1948: ILO Convention 81 on Labour Inspection</h4>
                <p>The ILO‚Äôs Labour Inspection Convention influenced South Africa to strengthen workplace safety oversight.</p>
            </div>
            <div class="carousel-item" data-index="17">
                <h4>ü©∫ 1973: Occupational Diseases Act in South Africa</h4>
                <p>Compensation for diseases like silicosis and asbestosis was consolidated, effective October 1973.</p>
            </div>
            <div class="carousel-item" data-index="18">
                <h4>üìã 1976: Erasmus Commission on OHS</h4>
                <p>The Erasmus Commission examined OHS shortcomings across South African industries, highlighting enforcement gaps.</p>
            </div>
            <div class="carousel-item" data-index="19">
                <h4>ü™ñ 1982: National Union of Mineworkers (NUM)</h4>
                <p>NUM was founded, advocating for better mine safety and black workers‚Äô rights under apartheid.</p>
            </div>
            <div class="carousel-item" data-index="20">
                <h4>üìâ 1980s: Job Insecurity in South Africa</h4>
                <p>High unemployment and sanctions increased job insecurity, deterring workers from demanding safer conditions.</p>
            </div>
            <div class="carousel-item" data-index="21">
                <h4>üìä 1987: Manpower Survey in South Africa</h4>
                <p>The survey highlighted hazardous job concentration among non-white workers, exacerbating OHS risks.</p>
            </div>
            <div class="carousel-item" data-index="22">
                <h4>üìú 1992: IOHSA in South Africa</h4>
                <p>The Institute of Occupational Hygienists of Southern Africa was formed, professionalizing OHS.</p>
            </div>
            <div class="carousel-item" data-index="23">
                <h4>üìã 1993: OHS Act in South Africa</h4>
                <p>The Occupational Health and Safety Act introduced universal OHS frameworks, including risk assessments.</p>
            </div>
            <div class="carousel-item" data-index="24">
                <h4>ü©∫ 1993: COIDA in South Africa</h4>
                <p>The Compensation for Occupational Injuries and Diseases Act provided compensation across industries.</p>
            </div>
            <div class="carousel-item" data-index="25">
                <h4>üë• 1994: Gender Integration in South Africa</h4>
                <p>Post-apartheid workplace gender integration increased women‚Äôs exposure to OHS risks in male-dominated sectors.</p>
            </div>
            <div class="carousel-item" data-index="26">
                <h4>üë©‚Äçüè≠ 1995: Women in Mining</h4>
                <p>Women faced ergonomic and psychosocial hazards in South African mines, often in low-skilled roles.</p>
            </div>
            <div class="carousel-item" data-index="27">
                <h4>üìú 1996: Mine Health and Safety Act</h4>
                <p>South Africa strengthened mine safety with mandatory accident reporting and inspectorate powers.</p>
            </div>
            <div class="carousel-item" data-index="28">
                <h4>‚öñÔ∏è 1996: SA Constitution and OHS</h4>
                <p>The South African Constitution enshrined the right to a safe work environment in the Bill of Rights.</p>
            </div>
            <div class="carousel-item" data-index="29">
                <h4>üåç 1997: SADC HIV Programs</h4>
                <p>Southern African mines introduced HIV prevention programs, but they had limited OHS impact.</p>
            </div>
            <div class="carousel-item" data-index="30">
                <h4>üåç 1999: Global OHS Research Gap</h4>
                <p>Leading OHS journals focused on workplace issues, often neglecting developing countries like South Africa.</p>
            </div>
            <div class="carousel-item" data-index="31">
                <h4>‚öñÔ∏è 2000: Lubbe v Cape plc</h4>
                <p>SA asbestos victims sued UK companies, setting a global precedent for corporate OHS accountability.</p>
            </div>
            <div class="carousel-item" data-index="32">
                <h4>üìú 2001: King II Report in South Africa</h4>
                <p>The King II Report integrated OHS into corporate governance, emphasizing social responsibility.</p>
            </div>
            <div class="carousel-item" data-index="33">
                <h4>üìâ 2001-2020: Inconsistent OHS Data</h4>
                <p>South Africa‚Äôs lack of a national OHS surveillance system led to inconsistent occupational disease reporting.</p>
            </div>
            <div class="carousel-item" data-index="34">
                <h4>üõ†Ô∏è 2003: Informal Labour in Kenya</h4>
                <p>Kenyan informal workers faced unsafe conditions, a trend mirrored in South Africa‚Äôs informal sector.</p>
            </div>
            <div class="carousel-item" data-index="35">
                <h4>üìú 2004: Companies Act and OHS</h4>
                <p>South Africa‚Äôs Companies Act began emphasizing OHS in corporate responsibility frameworks.</p>
            </div>
            <div class="carousel-item" data-index="36">
                <h4>üìâ 2008: Rising Unemployment in South Africa</h4>
                <p>Unemployment exceeded 30%, driving workers into hazardous informal jobs with poor OHS standards.</p>
            </div>
            <div class="carousel-item" data-index="37">
                <h4>üìú 2009: King III Report and ESG</h4>
                <p>King III integrated OHS into ESG frameworks, urging companies to prioritize workplace safety.</p>
            </div>
            <div class="carousel-item" data-index="38">
                <h4>üåç 2010: ILO WISE Program Influence</h4>
                <p>The ILO‚Äôs WISE program influenced South African small enterprises to adopt practical OHS improvements.</p>
            </div>
            <div class="carousel-item" data-index="39">
                <h4>‚õèÔ∏è 2011: Artisanal Mining in Africa</h4>
                <p>Artisanal mining exposed workers to dust and fumes, impacting South African Zama Zamas similarly.</p>
            </div>
            <div class="carousel-item" data-index="40">
                <h4>üõí 2012: Spaza Shops OHS Risks</h4>
                <p>South African spaza shops faced OHS issues like poor ventilation and fire hazards in informal settings.</p>
            </div>
            <div class="carousel-item" data-index="41">
                <h4>üîã 2013: Green Tech Mining Concerns</h4>
                <p>Cobalt mining for EV batteries in the DRC exposed workers to toxic chemicals, influencing SA‚Äôs green tech OHS debates.</p>
            </div>
            <div class="carousel-item" data-index="42">
                <h4>üåç 2014: E-Waste Dumping in Africa</h4>
                <p>E-waste dumping in West Africa released toxins, impacting SA workers through similar disposal practices.</p>
            </div>
            <div class="carousel-item" data-index="43">
                <h4>‚õèÔ∏è 2015: Zama Zamas in South Africa</h4>
                <p>Over 30,000 Zama Zamas operated in 6,000 abandoned SA mines, facing unsupported tunnels and gas risks.</p>
            </div>
            <div class="carousel-item" data-index="44">
                <h4>üö® 2016: Crime and OHS in South Africa</h4>
                <p>Violent crime in SA mining towns exposed security guards to OHS risks like assault and trauma.</p>
            </div>
            <div class="carousel-item" data-index="45">
                <h4>üåç 2017: Global Initiative on Zama Zamas</h4>
                <p>A report highlighted crime in SA‚Äôs Zama Zama sector, including gang violence affecting worker safety.</p>
            </div>
            <div class="carousel-item" data-index="46">
                <h4>‚öñÔ∏è 2018: PSA obo Members v Minister</h4>
                <p>A case reaffirmed employer duty under SA‚Äôs OHS Act after unsafe government building conditions were reported.</p>
            </div>
            <div class="carousel-item" data-index="47">
                <h4>üë© 2019: Gender Discrimination in Zama Zamas</h4>
                <p>Female Zama Zamas faced sexual abuse and restricted site access, increasing their OHS vulnerabilities.</p>
            </div>
            <div class="carousel-item" data-index="48">
                <h4>üå± 2020: Green Tech Disposal Risks</h4>
                <p>Disposal of rare earth elements for green tech in SA raised OHS concerns like chemical exposure.</p>
            </div>
            <div class="carousel-item" data-index="49">
                <h4>üìâ 2021: Unemployment and Informal Work</h4>
                <p>SA‚Äôs unemployment rate hit 45%, pushing workers into unsafe informal roles with minimal OHS protections.</p>
            </div>
            <button class="carousel-prev">‚ùÆ</button>
            <button class="carousel-next">‚ùØ</button>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-8 mt-auto">
        <div class="container mx-auto px-6 text-center">
            <p class="mb-2" data-i18n="footer.copyright">¬© 2025 SafetyHelp. All rights reserved.</p>
            <p class="mb-4">
                <a href="/safety-plans/privacy.html" data-i18n="footer.links.privacy" class="mx-2 hover:text-blue-400">Privacy Policy</a> |
                <a href="/safety-plans/terms.html" data-i18n="footer.links.terms" class="mx-2 hover:text-blue-400">Terms of Service</a> |
                <a href="/safety-plans/contact.html" data-i18n="footer.links.contact" class="mx-2 hover:text-blue-400">Contact Us</a>
            </p>
            <div class="newsletter mt-6">
                <h3 class="text-lg font-semibold mb-3" data-i18n="footer.newsletter.title">Stay Updated</h3>
                <form class="flex justify-center">
                    <input type="email" data-i18n="[placeholder]footer.newsletter.placeholder" placeholder="Enter your email" aria-label="Email for newsletter" class="px-3 py-2 border border-gray-300 rounded-l text-gray-800 w-64">
                    <button type="submit" data-i18n="footer.newsletter.button" class="px-4 py-2 rounded-r">Subscribe</button>
                </form>
            </div>
        </div>
    </footer>

    <!-- Modal for Carousel Detailed Info -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close-btn">√ó</span>
            <div id="modal-body"></div>
        </div>
    </div>

    <!-- Chatbot Container -->
    <div class="chatbot-container">
        <button id="chat-toggle" class="chat-toggle-btn p-3 rounded-full shadow-lg flex items-center justify-center">
            <span class="chat-icon text-2xl mr-1">‚õëÔ∏è</span> <span data-i18n="chatbot.button">Ask Me</span>
        </button>
        <div id="chat-window" class="chat-hidden bg-white border border-gray-300 rounded-lg shadow-xl">
            <div id="chat-output" class="p-3 text-sm h-80 overflow-y-scroll">
                <p><strong>Chatbot:</strong> <span data-i18n="chatbot.welcome">Hello! How can I help you with OHS today?</span></p>
            </div>
            <div id="chat-input-container" class="flex border-t border-gray-200">
                <input id="chat-input" type="text" data-i18n="[placeholder]chatbot.input_placeholder" placeholder="Ask about OHS..." aria-label="Ask about OHS" class="flex-grow p-2 border-none focus:outline-none">
                <button id="chat-send" aria-label="Send message" data-i18n="chatbot.send" class="px-4 py-2">Send</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script>
        // Translation Initialization with Embedded English Translations
        document.addEventListener('DOMContentLoaded', async () => {
            const translations = {
                "header.tagline": "Safety Personalized, Compliance Simplified‚ÄîAnytime, Anywhere",
                "header.nav.home": "Home",
                "header.nav.resources": "Resources",
                "header.nav.services": "Services",
                "header.nav.community": "Community",
                "header.nav.about": "About",
                "header.nav.contact": "Contact",
                "header.nav.login": "Login",
                "header.search.placeholder": "Search OHS Tools...",
                "header.search.button": "Search",
                "language_selector.en": "English",
                "language_selector.af": "Afrikaans",
                "language_selector.zu": "isiZulu",
                "language_selector.xh": "isiXhosa",
                "language_selector.st": "Sesotho",
                "language_selector.tn": "Setswana",
                "language_selector.nso": "Sepedi",
                "language_selector.ts": "Xitsonga",
                "language_selector.ss": "siSwati",
                "language_selector.ve": "Tshivenda",
                "language_selector.nr": "isiNdebele",
                "language_selector.es": "Espa√±ol",
                "language_selector.fr": "French",
                "language_selector.sn": "Shona",
                "language_selector.sw": "Swahili",
                "language_selector.zh": "Mandarin",
                "sidebar.ohs_tools": "SafetyHelp OHS Tools",
                "sidebar.construction_safety": "Construction Safety",
                "sidebar.emergency_planning": "Emergency Planning",
                "sidebar.risk_assessment": "Risk Assessment",
                "sidebar.legal_appointments": "Legal Appointments",
                "sidebar.incident_management": "Incident Management",
                "sidebar.training": "Training",
                "sidebar.inspections_audits": "Inspections & Audits",
                "sidebar.suppliers": "Suppliers",
                "sidebar.legislation": "Legislation",
                "sidebar.community_tools": "Community Tools",
                "sidebar.member_dashboard": "Member Dashboard",
                "sidebar.ohs_system": "OHS System",
                "sidebar.step_0.title": "üìú Welcome to SafetyHelp",
                "sidebar.step_0.description": "Explore our comprehensive tools and resources to enhance occupational health and safety in your workplace.",
                "sidebar.step_0.fun_fact": "‚ö° Did you know using reputable ethical suppliers can reduce workplace hazards by ensuring work is done on time and to the highest quality and safety standards?",
                "intro.title": "Comprehensive Emergency Response Planning",
                "intro.description": "Develop tailored emergency response plans to ensure safety and compliance with South African OHS regulations. Select your planning method manually or use our wizard for personalized recommendations based on your industry, location, and risks.",
                "select_method.title": "Select Your Planning Method",
                "footer.copyright": "¬© 2025 SafetyHelp. All rights reserved.",
                "footer.links.privacy": "Privacy Policy",
                "footer.links.terms": "Terms of Service",
                "footer.links.contact": "Contact Us",
                "footer.newsletter.title": "Stay Updated",
                "footer.newsletter.placeholder": "Enter your email",
                "footer.newsletter.button": "Subscribe",
                "chatbot.button": "Ask Me",
                "chatbot.input_placeholder": "Ask about OHS...",
                "chatbot.send": "Send",
                "chatbot.welcome": "Hello! How can I help you with OHS today?"
            };

            await i18next.init({
                lng: 'en',
                resources: {
                    en: { translation: translations }
                },
                debug: true
            });

            updateContent();

            document.getElementById('language-select').addEventListener('change', (e) => {
                i18next.changeLanguage(e.target.value, (err) => {
                    if (err) {
                        console.error('Error changing language:', err);
                        return;
                    }
                    updateContent();
                });
            });

            function updateContent() {
                document.querySelectorAll('[data-i18n]').forEach(element => {
                    const key = element.getAttribute('data-i18n');
                    if (element.hasAttribute('placeholder')) {
                        element.setAttribute('placeholder', i18next.t(key));
                    } else {
                        element.innerHTML = i18next.t(key);
                    }
                });
            }

            // Firebase Initialization
            const firebaseConfig = {
                apiKey: "AIzaSyDASGZnUyav23Mte5Q96H0j-T3LlGzVK-k",
                authDomain: "safetyfirst2025-aea34.firebaseapp.com",
                projectId: "safetyfirst2025-aea34",
                storageBucket: "safetyfirst2025-aea34.firebasestorage.app",
                messagingSenderId: "620306944192",
                appId: "1:620306944192:web:ddadeef6825901068a9d25",
                measurementId: "G-VQL1FCD8NN"
            };
            firebase.initializeApp(firebaseConfig);
            const db = firebase.firestore();

            // Carousel Functionality
            const carouselItems = document.querySelectorAll('.carousel-item');
            const prevBtn = document.querySelector('.carousel-prev');
            const nextBtn = document.querySelector('.carousel-next');
            let currentIndex = Math.floor(Math.random() * carouselItems.length);

            function showItem(index) {
                carouselItems.forEach(item => item.classList.remove('active'));
                carouselItems[index].classList.add('active');
            }

            prevBtn.addEventListener('click', () => {
                currentIndex = (currentIndex - 1 + carouselItems.length) % carouselItems.length;
                showItem(currentIndex);
            });

            nextBtn.addEventListener('click', () => {
                currentIndex = (currentIndex + 1) % carouselItems.length;
                showItem(currentIndex);
            });

            showItem(currentIndex);

            // Modal for Carousel Items
            const modal = document.getElementById('modal');
            const modalBody = document.getElementById('modal-body');
            const closeBtn = document.querySelector('.close-btn');

            const detailedContent = [
                { title: 'üåç Prehistoric Era: Early OHS Practices', summary: 'Early humans used communal knowledge to train hunters on safe tool use, minimizing injuries.', details: 'Prehistoric communities globally relied on oral traditions to pass down safety practices, such as safe hunting techniques and the use of natural remedies for injuries, laying the foundation for OHS.', link: 'https://www.sahistory.org.za/article/indigenous-knowledge-systems' },
                { title: 'üèπ 3000 BCE: Ancient Egypt OHS', summary: 'Egyptian pyramid builders used ramps to reduce lifting injuries, an early ergonomic practice.', details: 'Ancient Egyptians implemented ramps and sledges to move heavy stones, reducing physical strain and setting a precedent for ergonomic considerations in labor-intensive work.', link: 'https://www.history.com/topics/ancient-egypt/the-egyptian-pyramids' },
                { title: '‚öíÔ∏è 1800 BCE: Babylonian Code of Hammurabi', summary: 'The Code of Hammurabi included laws on workplace accountability, like penalties for builders if structures collapsed.', details: 'One of the earliest legal codes, the Code of Hammurabi held builders accountable for structural failures, marking an early step in workplace responsibility.', link: 'https://www.britannica.com/topic/Code-of-Hammurabi' },
                { title: 'ü©∫ 400 BCE: Hippocrates on Lead Poisoning', summary: 'Greek physician Hippocrates described lead poisoning in miners, an early recognition of occupational disease.', details: 'Hippocrates noted symptoms like abdominal pain in miners, linking lead exposure to health issues and influencing later OHS awareness globally.', link: 'https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1039204/' },
                { title: 'üè∫ 200 BCE: Roman OHS Innovations', summary: 'Romans used aqueducts to reduce worker exposure to contaminated water, improving health on construction sites.', details: 'Roman engineering provided clean water via aqueducts, reducing waterborne diseases among workers and setting a standard for environmental health in OHS.', link: 'https://www.ancient.eu/Roman_Aqueducts/' },
                { title: 'üåø Pre-1652: Precolonial South Africa OHS', summary: 'Bantu and Khoisan communities used medicinal plants like aloe to treat work-related injuries.', details: 'Indigenous South Africans used natural remedies and communal knowledge to address injuries from hunting and farming, showcasing early OHS practices.', link: 'https://www.sahistory.org.za/article/indigenous-knowledge-systems' },
                { title: 'ü™ì Pre-1652: Task Rotation in South Africa', summary: 'Indigenous South Africans practiced task rotation in agriculture to reduce fatigue and injury risks.', details: 'Task rotation among Bantu communities minimized repetitive strain injuries, a practice that aligns with modern ergonomic principles in OHS.', link: 'https://www.sahistory.org.za/article/indigenous-knowledge-systems' },
                { title: '‚öíÔ∏è 1652: Dutch East India Company in Cape Town', summary: 'The Dutch introduced European trades like carpentry, bringing new workplace hazards to South Africa.', details: 'The arrival of the Dutch East India Company introduced carpentry and masonry, exposing workers to new risks like tool injuries and dust exposure.', link: 'https://www.sahistory.org.za/article/dutch-east-india-company-voc' },
                { title: '‚õèÔ∏è 1867: Mineral Revolution in South Africa', summary: 'Diamond discovery in Hopetown led to deep-shaft mining, exposing workers to cave-ins and silica dust.', details: 'Erasmus Jacobs‚Äô discovery sparked mass labor migration, with workers facing deadly risks like cave-ins and silicosis from silica dust exposure.', link: 'https://www.sahistory.org.za/article/mineral-revolution' },
                { title: 'ü™® 1871: Kimberley Deep-Shaft Mining Risks', summary: 'Kimberley mines introduced risks like toxic gas exposure, with over 50,000 workers affected by 1875.', details: 'Deep-shaft mining in Kimberley led to carbon monoxide poisoning and cave-ins, with over 50,000 workers exposed by 1875, highlighting early OHS challenges.', link: 'https://www.sahistory.org.za/article/mineral-revolution' },
                { title: 'üè≠ 1886: Witwatersrand Gold Rush', summary: 'The gold rush in Johannesburg led to over 1,000 annual fatalities by 1904 due to rockfalls and explosions.', details: 'The Witwatersrand gold rush established Johannesburg as a mining hub, but poor safety led to over 1,000 deaths yearly by 1904 from preventable accidents.', link: 'https://www.dmr.gov.za/mine-health-and-safety' },
                { title: 'üõ†Ô∏è 1886: Industrial OHS in South Africa', summary: 'Factories in Cape Town and Johannesburg introduced risks like machinery entanglement and chemical burns.', details: 'Early factories brought new OHS hazards like entanglement in machinery and exposure to chemicals, with little regulation to protect workers.', link: 'https://www.sahistory.org.za/article/industrialisation-south-africa' },
                { title: 'üåç 1893: Migrant Labour System in South Africa', summary: 'The Chamber of Mines created a migrant labour system, exposing black workers to hazardous jobs.', details: 'The migrant labour system entrenched racial disparities, assigning black workers to the most dangerous mining tasks with minimal safety protections.', link: 'https://www.sahistory.org.za/article/migrant-labour-system' },
                { title: 'üìú 1911: Mines and Works Act in South Africa', summary: 'South Africa‚Äôs first OHS framework mandated mine inspectors but enforced a ‚Äúcolour bar‚Äù limiting safety roles to white workers.', details: 'The Act introduced ventilation standards and banned hazardous practices, but racial policies increased risks for black workers.', link: 'https://en.wikipedia.org/wiki/Mines_and_Works_Act' },
                { title: 'ü©∫ 1912: Silicosis Compensation in South Africa', summary: 'Temporary compensation for silicosis was introduced, with over 20% of miners affected by 1920.', details: 'Silicosis affected over 20% of South African miners by 1920, prompting temporary compensation schemes to address occupational lung disease.', link: 'https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1748-0361.2007.00114.x' },
                { title: 'üö® 1932: Safety First Association in South Africa', summary: 'Sir Ernest Oppenheimer founded the Safety First Association to promote accident prevention in mines.', details: 'The Safety First Association launched campaigns and training, laying the groundwork for modern safety culture in South African workplaces.', link: 'https://safety1st.co.za/about-us/' },
                { title: 'üåç 1948: ILO Convention 81 on Labour Inspection', summary: 'The ILO‚Äôs Labour Inspection Convention influenced South Africa to strengthen workplace safety oversight.', details: 'ILO Convention 81 emphasized the need for robust labour inspections, pushing South Africa to improve OHS enforcement mechanisms.', link: 'https://www.ilo.org/dyn/normlex/en/f?p=NORMLEXPUB:12100:0::NO::P12100_ILO_CODE:C081' },
                { title: 'ü©∫ 1973: Occupational Diseases Act in South Africa', summary: 'Compensation for diseases like silicosis and asbestosis was consolidated, effective October 1973.', details: 'The Act streamlined compensation for occupational diseases, addressing long-standing issues like silicosis in South African mines.', link: 'https://www.gov.za/documents/occupational-diseases-mines-and-works-act' },
                { title: 'üìã 1976: Erasmus Commission on OHS', summary: 'The Erasmus Commission examined OHS shortcomings across South African industries, highlighting enforcement gaps.', details: 'The Commission revealed poor enforcement and unsafe conditions, calling for stronger OHS regulations across sectors.', link: 'https://www.sciencedirect.com/science/article/abs/pii/027795368190142X' },
                { title: 'ü™ñ 1982: National Union of Mineworkers (NUM)', summary: 'NUM was founded, advocating for better mine safety and black workers‚Äô rights under apartheid.', details: 'NUM‚Äôs advocacy led to improved safety standards and highlighted racial disparities in OHS protections.', link: 'https://www.num.org.za/About-Us/History' },
                { title: 'üìâ 1980s: Job Insecurity in South Africa', summary: 'High unemployment and sanctions increased job insecurity, deterring workers from demanding safer conditions.', details: 'Economic pressures and sanctions made workers reluctant to report OHS violations, fearing job loss.', link: 'https://www.sahistory.org.za/article/economic-sanctions-against-apartheid' },
                { title: 'üìä 1987: Manpower Survey in South Africa', summary: 'The survey highlighted hazardous job concentration among non-white workers, exacerbating OHS risks.', details: 'Non-white workers were disproportionately assigned to dangerous roles, increasing their exposure to OHS hazards.', link: 'https://www.sciencedirect.com/science/article/abs/pii/027795368190142X' },
                { title: 'üìú 1992: IOHSA in South Africa', summary: 'The Institute of Occupational Hygienists of Southern Africa was formed, professionalizing OHS.', details: 'IOHSA‚Äôs formation marked a step toward professionalizing OHS practices and improving workplace safety standards.', link: 'https://www.occhealth.co.za/about-us' },
                { title: 'üìã 1993: OHS Act in South Africa', summary: 'The Occupational Health and Safety Act introduced universal OHS frameworks, including risk assessments.', details: 'The Act mandated risk assessments and safety committees, revolutionizing workplace safety in South Africa.', link: 'https://www.gov.za/documents/occupational-health-and-safety-act' },
                { title: 'ü©∫ 1993: COIDA in South Africa', summary: 'The Compensation for Occupational Injuries and Diseases Act provided compensation across industries.', details: 'COIDA ensured workers in all sectors could claim compensation for workplace injuries and diseases.', link: 'https://www.gov.za/documents/compensation-occupational-injuries-and-diseases-act' },
                { title: 'üë• 1994: Gender Integration in South Africa', summary: 'Post-apartheid workplace gender integration increased women‚Äôs exposure to OHS risks in male-dominated sectors.', details: 'Women entering mining and construction faced ergonomic hazards and discrimination, necessitating new OHS policies.', link: 'https://www.sahistory.org.za/article/women-and-work-post-1994' },
                { title: 'üë©‚Äçüè≠ 1995: Women in Mining', summary: 'Women faced ergonomic and psychosocial hazards in South African mines, often in low-skilled roles.', details: 'Women miners dealt with ill-fitting equipment and harassment, highlighting the need for gender-specific OHS measures.', link: 'https://www.scielosp.org/article/bwho/2001.v79n9/863-868/en/' },
                { title: 'üìú 1996: Mine Health and Safety Act', summary: 'South Africa strengthened mine safety with mandatory accident reporting and inspectorate powers.', details: 'The Act improved safety oversight by mandating reporting and empowering inspectors to enforce regulations.', link: 'https://www.dmr.gov.za/mine-health-and-safety' },
                { title: '‚öñÔ∏è 1996: SA Constitution and OHS', summary: 'The South African Constitution enshrined the right to a safe work environment in the Bill of Rights.', details: 'This constitutional right provided a legal basis for enforcing OHS standards across all workplaces.', link: 'https://www.gov.za/documents/constitution-republic-south-africa-1996' },
                { title: 'üåç 1997: SADC HIV Programs', summary: 'Southern African mines introduced HIV prevention programs, but they had limited OHS impact.', details: 'While HIV programs addressed health, they often overlooked broader OHS issues like workplace safety.', link: 'https://www.sciencedirect.com/science/article/abs/pii/027795368190142X' },
                { title: 'üåç 1999: Global OHS Research Gap', summary: 'Leading OHS journals focused on workplace issues, often neglecting developing countries like South Africa.', details: 'Research gaps limited the global understanding of OHS challenges in developing regions like South Africa.', link: 'https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1446872/' },
                { title: '‚öñÔ∏è 2000: Lubbe v Cape plc', summary: 'SA asbestos victims sued UK companies, setting a global precedent for corporate OHS accountability.', details: 'The case allowed compensation for thousands of SA workers, highlighting the need for global OHS standards.', link: 'https://en.wikipedia.org/wiki/Lubbe_v_Cape_plc' },
                { title: 'üìú 2001: King II Report in South Africa', summary: 'The King II Report integrated OHS into corporate governance, emphasizing social responsibility.', details: 'King II urged companies to prioritize OHS as part of ethical governance, influencing SA business practices.', link: 'https://www.iodsa.co.za/page/KingII' },
                { title: 'üìâ 2001-2020: Inconsistent OHS Data', summary: 'South Africa‚Äôs lack of a national OHS surveillance system led to inconsistent occupational disease reporting.', details: 'Without a surveillance system, SA struggled to track occupational diseases like noise-induced hearing loss.', link: 'https://www.mdpi.com/2071-1050/14/17/10464' },
                { title: 'üõ†Ô∏è 2003: Informal Labour in Kenya', summary: 'Kenyan informal workers faced unsafe conditions, a trend mirrored in South Africa‚Äôs informal sector.', details: 'Informal workers lacked protective equipment, a common issue in SA‚Äôs informal workplaces like spaza shops.', link: 'https://academic.oup.com/annweh/article/50/5/445/149350' },
                { title: 'üìú 2004: Companies Act and OHS', summary: 'South Africa‚Äôs Companies Act began emphasizing OHS in corporate responsibility frameworks.', details: 'The Act encouraged companies to integrate OHS into their operations, aligning with global standards.', link: 'https://www.gov.za/documents/companies-act' },
                { title: 'üìâ 2008: Rising Unemployment in South Africa', summary: 'Unemployment exceeded 30%, driving workers into hazardous informal jobs with poor OHS standards.', details: 'High unemployment pushed workers into unsafe informal roles, increasing OHS risks like injuries and stress.', link: 'https://www.trade.gov/country-commercial-guides/south-africa-market-challenges' },
                { title: 'üìú 2009: King III Report and ESG', summary: 'King III integrated OHS into ESG frameworks, urging companies to prioritize workplace safety.', details: 'King III linked OHS to environmental, social, and governance (ESG) criteria, enhancing corporate accountability.', link: 'https://www.iodsa.co.za/page/KingIII' },
                { title: 'üåç 2010: ILO WISE Program Influence', summary: 'The ILO‚Äôs WISE program influenced South African small enterprises to adopt practical OHS improvements.', details: 'The WISE program promoted low-cost safety solutions, benefiting small businesses in SA‚Äôs informal sector.', link: 'https://www.ncbi.nlm.nih.gov/books/NBK224697/' },
                { title: '‚õèÔ∏è 2011: Artisanal Mining in Africa', summary: 'Artisanal mining exposed workers to dust and fumes, impacting South African Zama Zamas similarly.', details: 'Artisanal mining risks like dust exposure in Zambia mirrored those faced by SA‚Äôs Zama Zamas.', link: 'https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6358123/' },
                { title: 'üõí 2012: Spaza Shops OHS Risks', summary: 'South African spaza shops faced OHS issues like poor ventilation and fire hazards in informal settings.', details: 'Spaza shops, common in SA townships, often lacked fire safety measures, posing risks to workers and customers.', link: 'https://www.scielosp.org/article/bwho/2001.v79n9/863-868/en/' },
                { title: 'üîã 2013: Green Tech Mining Concerns', summary: 'Cobalt mining for EV batteries in the DRC exposed workers to toxic chemicals, influencing SA‚Äôs green tech OHS debates.', details: 'Cobalt mining risks in the DRC raised concerns in SA about OHS in green tech mineral extraction.', link: 'https://www.sciencedirect.com/science/article/pii/S2214790X22000992' },
                { title: 'üåç 2014: E-Waste Dumping in Africa', summary: 'E-waste dumping in West Africa released toxins, impacting SA workers through similar disposal practices.', details: 'E-waste in Ghana and Nigeria exposed workers to lead and noise, a growing concern for SA‚Äôs informal recyclers.', link: 'https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6358123/' },
                { title: '‚õèÔ∏è 2015: Zama Zamas in South Africa', summary: 'Over 30,000 Zama Zamas operated in 6,000 abandoned SA mines, facing unsupported tunnels and gas risks.', details: 'Zama Zamas worked in dangerous conditions, with risks like methane explosions and tunnel collapses.', link: 'https://www.dailymaverick.co.za/article/2022-02-02-the-zama-zama-informal-mining-unlike-anything-else-in-the-world/' },
                { title: 'üö® 2016: Crime and OHS in South Africa', summary: 'Violent crime in SA mining towns exposed security guards to OHS risks like assault and trauma.', details: 'Crime in SA‚Äôs mining regions increased psychological stress and physical risks for security personnel.', link: 'https://www.newyorker.com/magazine/2023/02/27/the-dystopian-underworld-of-south-africas-illegal-gold-mines' },
                { title: 'üåç 2017: Global Initiative on Zama Zamas', summary: 'A report highlighted crime in SA‚Äôs Zama Zama sector, including gang violence affecting worker safety.', details: 'Syndicates controlling Zama Zama operations introduced violence, increasing OHS risks like assault underground.', link: 'https://www.sciencedirect.com/science/article/pii/S2214790X2300175X' },
                { title: '‚öñÔ∏è 2018: PSA obo Members v Minister', summary: 'A case reaffirmed employer duty under SA‚Äôs OHS Act after unsafe government building conditions were reported.', details: 'The case highlighted the need for government workplaces to comply with OHS standards, setting a precedent.', link: 'https://www.dmr.gov.za/mine-health-and-safety' },
                { title: 'üë© 2019: Gender Discrimination in Zama Zamas', summary: 'Female Zama Zamas faced sexual abuse and restricted site access, increasing their OHS vulnerabilities.', details: 'Women in Zama Zama mining endured harassment and limited safety resources, exacerbating OHS risks.', link: 'https://www.dispatchlive.co.za/news/2020-01-30-female-zama-zamas-suffer-sexual-abuse-and-discrimination-in-mining/' },
                { title: 'üå± 2020: Green Tech Disposal Risks', summary: 'Disposal of rare earth elements for green tech in SA raised OHS concerns like chemical exposure.', details: 'Improper disposal of green tech materials exposed SA workers to toxins, mirroring global e-waste issues.', link: 'https://www.mdpi.com/2071-1050/14/17/10464' },
                { title: 'üìâ 2021: Unemployment and Informal Work', summary: 'SA‚Äôs unemployment rate hit 45%, pushing workers into unsafe informal roles with minimal OHS protections.', details: 'High unemployment forced workers into informal sectors like Zama Zamas, increasing exposure to OHS hazards.', link: 'https://www.trade.gov/country-commercial-guides/south-africa-market-challenges' }
            ];

            carouselItems.forEach(item => {
                item.addEventListener('click', () => {
                    const index = item.getAttribute('data-index');
                    const content = detailedContent[index];
                    modalBody.innerHTML = `
                        <h4>${content.title}</h4>
                        <p>${content.details}</p>
                        <p><a href="${content.link}" target="_blank">Learn More</a></p>
                    `;
                    modal.style.display = 'flex';
                });
            });

            closeBtn.addEventListener('click', () => {
                modal.style.display = 'none';
            });

            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    modal.style.display = 'none';
                }
            });

            // Chatbot Functionality
            const chatToggle = document.getElementById('chat-toggle');
            const chatWindow = document.getElementById('chat-window');
            const chatOutput = document.getElementById('chat-output');
            const chatInput = document.getElementById('chat-input');
            const chatSend = document.getElementById('chat-send');

            chatToggle.addEventListener('click', () => {
                chatWindow.classList.toggle('chat-hidden');
                if (!chatWindow.classList.contains('chat-hidden')) {
                    chatInput.focus();
                }
            });

            async function sendQuery() {
                if (!db) {
                    addChatMessage('Chatbot', 'Sorry, the chatbot is currently unavailable.');
                    return;
                }
                const input = chatInput.value.trim();
                if (!input) return;
                addChatMessage('You', input);
                chatInput.value = '';
                addChatMessage('Chatbot', 'Searching...');
                const query = input.toLowerCase();

                try {
                    const snapshot = await db.collection('ohs-knowledge')
                                             .where('keywords', 'array-contains', query)
                                             .limit(1)
                                             .get();
                    let responseFound = false;
                    let response = "Sorry, I couldn‚Äôt find specific information on that topic. Please try rephrasing or ask a different question.";

                    if (!snapshot.empty) {
                        snapshot.forEach(doc => {
                            const data = doc.data();
                            response = `Based on information from ${data.book || 'our resources'} (Chapter ${data.chapter || 'N/A'}), here's a summary: <br>${data.content.substring(0, 250)}...`;
                            if (data.file) {
                                response += ` (See <a href="/safety-plans/resources/${data.file}" target="_blank" class="text-blue-500 hover:underline">full chapter</a>)`;
                            }
                            responseFound = true;
                        });
                    }
                    const searchingMessage = chatOutput.querySelector('p:last-child');
                    if (searchingMessage && searchingMessage.textContent.includes('Searching...')) {
                        searchingMessage.innerHTML = `<strong>Chatbot:</strong> ${response}`;
                    } else {
                        addChatMessage('Chatbot', response);
                    }
                } catch (error) {
                    console.error("Firestore query failed:", error);
                    const searchingMessage = chatOutput.querySelector('p:last-child');
                    if (searchingMessage && searchingMessage.textContent.includes('Searching...')) {
                        searchingMessage.innerHTML = `<strong>Chatbot:</strong> Oops, something went wrong while searching. Please try again!`;
                    } else {
                        addChatMessage('Chatbot', 'Oops, something went wrong while searching. Please try again!');
                    }
                }
            }

            function addChatMessage(sender, message) {
                if (chatOutput) {
                    const messageElement = document.createElement('p');
                    messageElement.classList.add('mb-2');
                    messageElement.innerHTML = `<strong>${sender}:</strong> ${message}`;
                    chatOutput.appendChild(messageElement);
                    chatOutput.scrollTop = chatOutput.scrollHeight;
                }
            }

            chatSend.addEventListener('click', sendQuery);
            chatInput.addEventListener('keypress', (event) => {
                if (event.key === 'Enter') sendQuery();
            });

            // Page Navigation
            const startPlanningBtn = document.getElementById('start-planning-btn');
            const selectMethodSection = document.getElementById('select-method-section');
            const wizardSection = document.getElementById('wizard-section');
            const categorySection = document.getElementById('category-section');
            const manualSection = document.getElementById('manual-section');
            const moduleActionsSection = document.getElementById('module-actions-section');
            const generatePolicySection = document.getElementById('generate-policy-section');
            const generateStandardsSection = document.getElementById('generate-standards-section');
            const createPlanSection = document.getElementById('create-plan-section');
            const conductDrillSection = document.getElementById('conduct-drill-section');
            const maintainRegisterSection = document.getElementById('maintain-register-section');
            const cartCheckoutSection = document.getElementById('cart-checkout-section');

            startPlanningBtn.addEventListener('click', () => {
                selectMethodSection.classList.remove('hidden');
                startPlanningBtn.classList.add('hidden');
            });

            // Select Method
            const methodCards = document.querySelectorAll('.method-card');
            methodCards.forEach(card => {
                card.addEventListener('click', () => {
                    const method = card.getAttribute('data-method');
                    selectMethodSection.classList.add('hidden');
                    if (method === 'wizard') {
                        wizardSection.classList.remove('hidden');
                    } else if (method === 'category') {
                        categorySection.classList.remove('hidden');
                    } else if (method === 'manual') {
                        manualSection.classList.remove('hidden');
                    }
                });
            });

            // Wizard Navigation
            const wizardStep1 = document.getElementById('wizard-step-1');
            const wizardStep2 = document.getElementById('wizard-step-2');
            const wizardStep3 = document.getElementById('wizard-step-3');
            const wizardRecommendations = document.getElementById('wizard-recommendations');
            const wizardNext1 = document.getElementById('wizard-next-1');
            const wizardNext2 = document.getElementById('wizard-next-2');
            const wizardBack2 = document.getElementById('wizard-back-2');
            const wizardBack3 = document.getElementById('wizard-back-3');
            const wizardFinish = document.getElementById('wizard-finish');
            const proceedToActions = document.getElementById('proceed-to-actions');

            let userProfile = {};

            wizardNext1.addEventListener('click', () => {
                const industry = document.getElementById('industry').value;
                const location = document.getElementById('location').value;
                if (industry && location) {
                    userProfile.industry = industry;
                    userProfile.location = location;
                    wizardStep1.classList.add('hidden');
                    wizardStep2.classList.remove('hidden');
                } else {
                    alert('Please select both industry and location.');
                }
            });

            const fireRiskSlider = document.getElementById('fire-risk');
            const fireRiskLabel = document.getElementById('fire-risk-label');
            const medicalRiskSlider = document.getElementById('medical-risk');
            const medicalRiskLabel = document.getElementById('medical-risk-label');
            const chemicalRiskSlider = document.getElementById('chemical-risk');
            const chemicalRiskLabel = document.getElementById('chemical-risk-label');

            fireRiskSlider.addEventListener('input', () => {
                const value = fireRiskSlider.value;
                fireRiskLabel.textContent = value == 1 ? 'Low' : value == 2 ? 'Medium' : 'High';
            });

            medicalRiskSlider.addEventListener('input', () => {
                const value = medicalRiskSlider.value;
                medicalRiskLabel.textContent = value == 1 ? 'Low' : value == 2 ? 'Medium' : 'High';
            });

            chemicalRiskSlider.addEventListener('input', () => {
                const value = chemicalRiskSlider.value;
                chemicalRiskLabel.textContent = value == 1 ? 'Low' : value == 2 ? 'Medium' : 'High';
            });

            wizardNext2.addEventListener('click', () => {
                const activities = Array.from(document.querySelectorAll('input[name="activities"]:checked')).map(input => input.value);
                const fireRisk = fireRiskSlider.value;
                const medicalRisk = medicalRiskSlider.value;
                const chemicalRisk = chemicalRiskSlider.value;
                if (activities.length > 0) {
                    userProfile.activities = activities;
                    userProfile.risks = { fire: fireRisk, medical: medicalRisk, chemical: chemicalRisk };
                    wizardStep2.classList.add('hidden');
                    wizardStep3.classList.remove('hidden');
                } else {
                    alert('Please select at least one activity.');
                }
            });

            wizardBack2.addEventListener('click', () => {
                wizardStep2.classList.add('hidden');
                wizardStep1.classList.remove('hidden');
            });

            wizardBack3.addEventListener('click', () => {
                wizardStep3.classList.add('hidden');
                wizardStep2.classList.remove('hidden');
            });

            wizardFinish.addEventListener('click', () => {
                const companySize = document.getElementById('company-size').value;
                const existingMeasures = document.querySelector('input[name="existing-measures"]:checked')?.value;
                if (companySize && existingMeasures) {
                    userProfile.companySize = companySize;
                    userProfile.existingMeasures = existingMeasures;

                    // Save user profile to Firestore
                    db.collection('userProfiles').add(userProfile)
                        .then(docRef => {
                            console.log("User profile saved with ID: ", docRef.id);
                        })
                        .catch(error => {
                            console.error("Error saving user profile: ", error);
                        });

                    // Generate Recommendations
                    const recommendationsList = document.getElementById('recommendations-list');
                    recommendationsList.innerHTML = '';
                    if (userProfile.industry === 'construction' && userProfile.risks.fire >= 2) {
                        const rec = document.createElement('div');
                        rec.innerHTML = `<p>Fire Evacuation Plan for Construction Sites in ${userProfile.location} (High Risk)</p>`;
                        recommendationsList.appendChild(rec);
                    }
                    if (userProfile.activities.includes('chemical_handling') && userProfile.risks.chemical >= 2) {
                        const rec = document.createElement('div');
                        rec.innerHTML = `<p>Chemical Spill Response Checklist for ${userProfile.companySize} Employees</p>`;
                        recommendationsList.appendChild(rec);
                    }
                    if (userProfile.location === 'western_cape') {
                        const rec = document.createElement('div');
                        rec.innerHTML = `<p>Flood Response Plan for ${userProfile.industry} in Western Cape</p>`;
                        recommendationsList.appendChild(rec);
                    }

                    wizardStep3.classList.add('hidden');
                    wizardRecommendations.classList.remove('hidden');
                } else {
                    alert('Please complete all fields.');
                }
            });

            proceedToActions.addEventListener('click', () => {
                wizardSection.classList.add('hidden');
                moduleActionsSection.classList.remove('hidden');
            });

            // Category Navigation
            const categoryCards = document.querySelectorAll('.category-card');
            const categoryOptions = document.getElementById('category-options');
            const categoryTitle = document.getElementById('category-title');
            const categoryOptionsList = document.getElementById('category-options-list');
            const categoryBack = document.getElementById('category-back');
            const categoryProceed = document.getElementById('category-proceed');

            const categoryData = {
                fire: [
                    { title: "Fire Evacuation Plan", description: "A detailed plan for evacuating during a fire emergency." },
                    { title: "Fire Safety Standard", description: "Standards for fire safety in your workplace." }
                ],
                medical: [
                    { title: "Medical Emergency Protocol", description: "Protocol for handling medical emergencies on-site." }
                ],
                chemical: [
                    { title: "Chemical Spill Response Checklist", description: "Checklist for safely managing chemical spills." }
                ],
                natural: [
                    { title: "Flood Response Plan", description: "Plan for responding to flood emergencies." }
                ]
            };

            categoryCards.forEach(card => {
                card.addEventListener('click', () => {
                    const category = card.getAttribute('data-category');
                    categoryTitle.textContent = category.charAt(0).toUpperCase() + category.slice(1);
                    categoryOptionsList.innerHTML = '';
                    categoryData[category].forEach(option => {
                        const div = document.createElement('div');
                        div.classList.add('bg-gray-50', 'p-4', 'rounded-lg', 'shadow', 'cursor-pointer');
                        div.innerHTML = `<h3 class="text-lg font-semibold text-gray-700 mb-2">${option.title}</h3><p class="text-gray-600 text-sm">${option.description}</p>`;
                        categoryOptionsList.appendChild(div);
                    });
                    categoryOptions.classList.remove('hidden');
                });
            });

            categoryBack.addEventListener('click', () => {
                categoryOptions.classList.add('hidden');
                categorySection.classList.remove('hidden');
            });

            categoryProceed.addEventListener('click', () => {
                categoryOptions.classList.add('hidden');
                categorySection.classList.add('hidden');
                moduleActionsSection.classList.remove('hidden');
            });

            // Manual Navigation
            const manualBack = document.getElementById('manual-back');
            const manualProceed = document.getElementById('manual-proceed');

            manualBack.addEventListener('click', () => {
                manualSection.classList.add('hidden');
                selectMethodSection.classList.remove('hidden');
            });

            manualProceed.addEventListener('click', () => {
                manualSection.classList.add('hidden');
                moduleActionsSection.classList.remove('hidden');
            });

            // Module Actions Navigation
            const actionCards = document.querySelectorAll('.action-card');
            actionCards.forEach(card => {
                card.addEventListener('click', () => {
                    const action = card.getAttribute('data-action');
                    moduleActionsSection.classList.add('hidden');
                    if (action === 'generate-policy') {
                        generatePolicySection.classList.remove('hidden');
                    } else if (action === 'generate-standards') {
                        generateStandardsSection.classList.remove('hidden');
                    } else if (action === 'create-plan') {
                        createPlanSection.classList.remove('hidden');
                    } else if (action === 'conduct-drill') {
                        conductDrillSection.classList.remove('hidden');
                    } else if (action === 'maintain-register') {
                        maintainRegisterSection.classList.remove('hidden');
                    }
                });
            });

            // Cart Management
            let cart = JSON.parse(localStorage.getItem('cart')) || [];

            function updateCart() {
                const cartItems = document.getElementById('cart-items');
                const cartTotal = document.getElementById('cart-total');
                cartItems.innerHTML = '';
                let total = 0;
                cart.forEach(item => {
                    const div = document.createElement('div');
                    div.classList.add('flex', 'justify-between', 'bg-gray-50', 'p-4', 'rounded-lg', 'shadow');
                    div.innerHTML = `<p>${item.name}</p><p>R${item.price}</p>`;
                    cartItems.appendChild(div);
                    total += item.price;
                });
                cartTotal.textContent = `Total: R${total}`;
                localStorage.setItem('cart', JSON.stringify(cart));
                if (cart.length > 0) {
                    cartCheckoutSection.classList.remove('hidden');
                }
            }

            // Generate Policy
            const generatePolicyBtn = document.getElementById('generate-policy-btn');
            const policyResult = document.getElementById('policy-result');
            const policyBack = document.getElementById('policy-back');

            generatePolicyBtn.addEventListener('click', async () => {
                const companyName = document.getElementById('company-name').value;
                if (companyName) {
                    const policyDoc = {
                        name: `${companyName} Emergency Response Policy`,
                        price: 50,
                        type: 'policy',
                        content: `Emergency Response Policy for ${companyName}\nRoles: ${userProfile.evacuationCoordinator || 'Not specified'}, ${userProfile.firstAider || 'Not specified'}\nCompliance: OHS Act 85 of 1993`
                    };
                    cart.push(policyDoc);
                    await db.collection('tempDocuments').add({
                        ...policyDoc,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    policyResult.classList.remove('hidden');
                    updateCart();
                } else {
                    alert('Please enter your company name.');
                }
            });

            policyBack.addEventListener('click', () => {
                generatePolicySection.classList.add('hidden');
                moduleActionsSection.classList.remove('hidden');
            });

            // Generate Standards
            const generateStandardBtn = document.getElementById('generate-standard-btn');
            const standardsResult = document.getElementById('standards-result');
            const standardsBack = document.getElementById('standards-back');

            generateStandardBtn.addEventListener('click', async () => {
                const standardType = document.getElementById('standard-type').value;
                if (standardType) {
                    const standardDoc = {
                        name: standardType === 'fire-standard' ? 'Fire Safety Standard' : standardType === 'fire-template' ? 'Fire Evacuation Template' : 'Chemical Spill Checklist',
                        price: standardType === 'fire-standard' ? 50 : 30,
                        type: 'standard',
                        content: `${standardType === 'fire-standard' ? 'Fire Safety Standard' : standardType === 'fire-template' ? 'Fire Evacuation Template' : 'Chemical Spill Checklist'} for ${userProfile.industry || 'General'}`
                    };
                    cart.push(standardDoc);
                    await db.collection('tempDocuments').add({
                        ...standardDoc,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    standardsResult.classList.remove('hidden');
                    updateCart();
                } else {
                    alert('Please select a standard/template type.');
                }
            });

            standardsBack.addEventListener('click', () => {
                generateStandardsSection.classList.add('hidden');
                moduleActionsSection.classList.remove('hidden');
            });

            // Create Plan
            const planStep1 = document.getElementById('plan-step-1');
            const planStep2 = document.getElementById('plan-step-2');
            const planStep3 = document.getElementById('plan-step-3');
            const planStep4 = document.getElementById('plan-step-4');
            const planNext1 = document.getElementById('plan-next-1');
            const planBack1 = document.getElementById('plan-back-1');
            const planNext2 = document.getElementById('plan-next-2');
            const planBack2 = document.getElementById('plan-back-2');
            const planNext3 = document.getElementById('plan-next-3');
            const planBack3 = document.getElementById('plan-back-3');
            const planFinish = document.getElementById('plan-finish');
            const planBack4 = document.getElementById('plan-back-4');
            const planResult = document.getElementById('plan-result');

            planNext1.addEventListener('click', () => {
                const scenarios = Array.from(document.querySelectorAll('input[name="scenarios"]:checked')).map(input => input.value);
                if (scenarios.length > 0) {
                    userProfile.scenarios = scenarios;
                    planStep1.classList.add('hidden');
                    planStep2.classList.remove('hidden');
                } else {
                    alert('Please select at least one scenario.');
                }
            });

            planBack1.addEventListener('click', () => {
                createPlanSection.classList.add('hidden');
                moduleActionsSection.classList.remove('hidden');
            });

            planNext2.addEventListener('click', () => {
                const evacuationCoordinator = document.getElementById('evacuation-coordinator').value;
                const firstAider = document.getElementById('first-aider').value;
                if (evacuationCoordinator && firstAider) {
                    userProfile.evacuationCoordinator = evacuationCoordinator;
                    userProfile.firstAider = firstAider;
                    planStep2.classList.add('hidden');
                    planStep3.classList.remove('hidden');
                } else {
                    alert('Please fill in all fields.');
                }
            });

            planBack2.addEventListener('click', () => {
                planStep2.classList.add('hidden');
                planStep1.classList.remove('hidden');
            });

            planNext3.addEventListener('click', () => {
                const exits = document.getElementById('exits').value;
                const assemblyPoints = document.getElementById('assembly-points').value;
                if (exits && assemblyPoints) {
                    userProfile.exits = exits;
                    userProfile.assemblyPoints = assemblyPoints;
                    planStep3.classList.add('hidden');
                    planStep4.classList.remove('hidden');
                } else {
                    alert('Please fill in all fields.');
                }
            });

            planBack3.addEventListener('click', () => {
                planStep3.classList.add('hidden');
                planStep2.classList.remove('hidden');
            });

            planFinish.addEventListener('click', async () => {
                const procedures = document.getElementById('procedures').value;
                if (procedures) {
                    userProfile.procedures = procedures;
                    const planDoc = {
                        name: "Emergency Response Plan",
                        price: 50,
                        type: 'plan',
                        content: `Emergency Response Plan\nScenarios: ${userProfile.scenarios.join(', ')}\nRoles: Evacuation Coordinator - ${userProfile.evacuationCoordinator}, First Aider - ${userProfile.firstAider}\nExits: ${userProfile.exits}\nAssembly Points: ${userProfile.assemblyPoints}\nProcedures: ${userProfile.procedures}`
                    };
                    cart.push(planDoc);
                    await db.collection('tempDocuments').add({
                        ...planDoc,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    planResult.classList.remove('hidden');
                    updateCart();
                } else {
                    alert('Please fill in the procedures.');
                }
            });

            planBack4.addEventListener('click', () => {
                planStep4.classList.add('hidden');
                planStep3.classList.remove('hidden');
            });

            // Conduct Drill
            const drillStep1 = document.getElementById('drill-step-1');
            const drillStep2 = document.getElementById('drill-step-2');
            const drillStep3 = document.getElementById('drill-step-3');
            const drillNext1 = document.getElementById('drill-next-1');
            const drillBack1 = document.getElementById('drill-back-1');
            const drillNext2 = document.getElementById('drill-next-2');
            const drillBack2 = document.getElementById('drill-back-2');
            const drillFinish = document.getElementById('drill-finish');
            const drillBack3 = document.getElementById('drill-back-3');
            const drillResult = document.getElementById('drill-result');

            drillNext1.addEventListener('click', () => {
                const drillDate = document.getElementById('drill-date').value;
                const drillScenario = document.getElementById('drill-scenario').value;
                if (drillDate && drillScenario) {
                    userProfile.drillDate = drillDate;
                    userProfile.drillScenario = drillScenario;
                    drillStep1.classList.add('hidden');
                    drillStep2.classList.remove('hidden');
                } else {
                    alert('Please fill in all fields.');
                }
            });

            drillBack1.addEventListener('click', () => {
                conductDrillSection.classList.add('hidden');
                moduleActionsSection.classList.remove('hidden');
            });

            drillNext2.addEventListener('click', () => {
                const participantsCount = document.getElementById('participants-count').value;
                const participantRoles = document.getElementById('participant-roles').value;
                if (participantsCount && participantRoles) {
                    userProfile.participantsCount = participantsCount;
                    userProfile.participantRoles = participantRoles;
                    drillStep2.classList.add('hidden');
                    drillStep3.classList.remove('hidden');
                } else {
                    alert('Please fill in all fields.');
                }
            });

            drillBack2.addEventListener('click', () => {
                drillStep2.classList.add('hidden');
                drillStep1.classList.remove('hidden');
            });

            drillFinish.addEventListener('click', async () => {
                const evacuationTime = document.getElementById('evacuation-time').value;
                const communicationRating = document.getElementById('communication-rating').value;
                if (evacuationTime && communicationRating) {
                    const drillDoc = {
                        name: "Emergency Drill Evaluation",
                        price: 30,
                        type: 'drill',
                        content: `Emergency Drill Evaluation\nDate: ${userProfile.drillDate}\nScenario: ${userProfile.drillScenario}\nParticipants: ${userProfile.participantsCount}\nRoles: ${userProfile.participantRoles}\nEvacuation Time: ${evacuationTime} minutes\nCommunication Rating: ${communicationRating}`
                    };
                    cart.push(drillDoc);
                    await db.collection('tempDocuments').add({
                        ...drillDoc,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    drillResult.classList.remove('hidden');
                    updateCart();
                } else {
                    alert('Please fill in all fields.');
                }
            });

            drillBack3.addEventListener('click', () => {
                drillStep3.classList.add('hidden');
                drillStep2.classList.remove('hidden');
            });

            // Maintain Register
            const registerType = document.getElementById('register-type');
            const registerDetails = document.getElementById('register-details');
            const addEntryBtn = document.getElementById('add-entry-btn');
            const registerEntries = document.getElementById('register-entries');
            const downloadRegisterBtn = document.getElementById('download-register-btn');
            const registerBack = document.getElementById('register-back');

            let registerData = JSON.parse(localStorage.getItem('registerData')) || [];

            registerType.addEventListener('change', () => {
                if (registerType.value) {
                    registerDetails.classList.remove('hidden');
                } else {
                    registerDetails.classList.add('hidden');
                }
            });

            addEntryBtn.addEventListener('click', async () => {
                const entryDate = document.getElementById('entry-date').value;
                const entryDetails = document.getElementById('entry-details').value;
                if (entryDate && entryDetails) {
                    const entry = {
                        type: registerType.value,
                        date: entryDate,
                        details: entryDetails
                    };
                    registerData.push(entry);
                    localStorage.setItem('registerData', JSON.stringify(registerData));
                    const div = document.createElement('div');
                    div.classList.add('bg-gray-50', 'p-4', 'rounded-lg', 'shadow');
                    div.innerHTML = `<p><strong>Type:</strong> ${entry.type}</p><p><strong>Date:</strong> ${entry.date}</p><p><strong>Details:</strong> ${entry.details}</p>`;
                    registerEntries.appendChild(div);
                    downloadRegisterBtn.classList.remove('hidden');
                } else {
                    alert('Please fill in all fields.');
                }
            });

            downloadRegisterBtn.addEventListener('click', async () => {
                const registerDoc = {
                    name: "Emergency Register",
                    price: 30,
                    type: 'register',
                    content: registerData.map(entry => `Type: ${entry.type}\nDate: ${entry.date}\nDetails: ${entry.details}`).join('\n\n')
                };
                cart.push(registerDoc);
                await db.collection('tempDocuments').add({
                    ...registerDoc,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                updateCart();
            });

            registerBack.addEventListener('click', () => {
                maintainRegisterSection.classList.add('hidden');
                moduleActionsSection.classList.remove('hidden');
            });

            // Checkout
            const checkoutBtn = document.getElementById('checkout-btn');
            const subscribeBtn = document.getElementById('subscribe-btn');

            checkoutBtn.addEventListener('click', async () => {
                const accessCode = 'ACCESS-' + Math.random().toString(36).substr(2, 9).toUpperCase();
                alert(`Checkout successful! Your access code is: ${accessCode}. Documents will be available for 7 days.`);
                await db.collection('invoices').add({
                    accessCode: accessCode,
                    cart: cart,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                cart = [];
                localStorage.setItem('cart', JSON.stringify(cart));
                cartCheckoutSection.classList.add('hidden');
            });

            subscribeBtn.addEventListener('click', () => {
                alert('Redirecting to subscription page... (Monthly: R200, Annual: R2000)');
                // Implement subscription logic here (e.g., redirect to Stripe payment page)
            });
        });

        // Note: Payment integration (e.g., Stripe) and PDF generation (e.g., pdfkit via Cloud Function) are assumed to be handled server-side.
    </script>

    <style>
        /* Main Content */
        .main-content {
            margin-left: 250px;
            flex-grow: 1;
            padding: 1.5rem;
            display: flex;
            flex-direction: row;
            gap: 20px;
        }
        .content-column {
            flex: 3;
            display: flex;
            flex-direction: column;
        }
        .intro, .select-method, .wizard, .category, .manual, .module-actions, .cart-checkout {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-bottom: 24px;
        }
        .intro h2, .select-method h2, .wizard h2, .category h2, .manual h2, .module-actions h2, .cart-checkout h2 {
            font-size: 24px;
            color: #333;
            margin-bottom: 10px;
        }
        .intro p, .select-method p, .wizard p, .category p, .manual p, .module-actions p, .cart-checkout p {
            font-size: 14px;
            color: #666;
            margin-bottom: 15px;
        }
        .intro button, .select-method button, .wizard button, .category button, .manual button, .module-actions button, .cart-checkout button {
            background-color: #FD7E14;
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            text-decoration: none;
            border: none;
            cursor: pointer;
        }
        .intro button:hover, .select-method button:hover, .wizard button:hover, .category button:hover, .manual button:hover, .module-actions button:hover, .cart-checkout button:hover {
            background-color: #e06b00;
        }
        .method-card, .category-card, .manual-option, .action-card {
            transition: transform 0.3s ease;
        }
        .method-card:hover, .category-card:hover, .manual-option:hover, .action-card:hover {
            transform: translateY(-5px);
        }
        /* Carousel */
        .carousel-container {
            flex: 1;
            max-width: 250px;
            position: relative;
        }
        .carousel-item {
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: transform 0.3s ease;
            margin-bottom: 10px;
        }
        .carousel-item:hover {
            transform: scale(1.05);
            font-weight: bold;
        }
        .carousel-item h4 {
            font-size: 16px;
            color: #007BFF;
            margin-bottom: 5px;
        }
        .carousel-item p {
            font-size: 14px;
            color: #333;
        }
        .carousel-item.active {
            display: block;
        }
        .carousel-item:not(.active) {
            display: none;
        }
        .carousel-prev, .carousel-next {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background-color: #FD7E14;
            color: white;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
            border-radius: 4px;
        }
        .carousel-prev:hover, .carousel-next:hover {
            background-color: #e06b00;
        }
        .carousel-prev {
            left: -50px;
        }
        .carousel-next {
            right: -50px;
        }
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            max-width: 500px;
            width: 90%;
            position: relative;
        }
        .modal-content h4 {
            font-size: 18px;
            color: #007BFF;
            margin-bottom: 10px;
        }
        .modal-content p {
            font-size: 14px;
            color: #333;
            margin-bottom: 10px;
        }
        .modal-content a {
            color: #28A745;
            text-decoration: underline;
        }
        .modal-content a:hover {
            color: #1e7e34;
        }
        .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 20px;
            cursor: pointer;
            color: #333;
        }
        /* Footer */
        footer {
            background-color: #007BFF;
            color: white;
            padding: 15px;
            text-align: center;
            width: 100%;
            margin-top: auto;
        }
        footer p {
            font-size: 14px;
            margin: 5px 0;
        }
        footer a {
            color: #FD7E14;
            text-decoration: none;
        }
        footer a:hover {
            color: #e06b00;
        }
        .newsletter h3 {
            font-size: 14px;
            margin-bottom: 8px;
        }
        .newsletter input {
            padding: 8px;
            border: none;
            border-radius: 2px;
            margin-right: 10px;
            font-size: 14px;
            width: 150px;
        }
        .newsletter button {
            padding: 8px 16px;
            background-color: #FD7E14;
            color: white;
            border: none;
            border-radius: 2px;
            cursor: pointer;
            font-size: 14px;
        }
        .newsletter button:hover {
            background-color: #e06b00;
        }
        /* Chatbot */
        .chatbot-container {
            position: fixed;
            bottom: 1.25rem;
            right: 1.25rem;
            z-index: 1000;
        }
        #chat-window {
            width: 300px;
            max-height: 400px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }
        .chat-hidden {
            display: none;
        }
        #chat-output {
            flex-grow: 1;
        }
        #chat-input-container {
            display: flex;
            border-top-width: 1px;
        }
        #chat-input {
            flex-grow: 1;
            border: none;
            padding: 0.5rem;
        }
        #chat-send {
            border: none;
            padding: 0.5rem 1rem;
            cursor: pointer;
            background-color: #007BFF;
            color: white;
        }
        #chat-send:hover {
            background-color: #0056b3;
        }
        .chat-toggle-btn {
            background-color: #FD7E14;
        }
        .chat-toggle-btn:hover {
            background-color: #e06b00;
        }
        /* Responsive adjustments */
        @media (max-width: 768px) {
            body {
                padding-top: 0;
                flex-direction: column;
            }
            header {
                position: relative;
            }
            .header-container {
                flex-direction: column;
                align-items: center;
            }
            .header-left {
                align-items: center;
                margin-bottom: 10px;
            }
            .nav-links {
                margin: 10px 0;
            }
            .nav-links a {
                margin: 5px 10px;
            }
            .header-right {
                align-items: center;
            }
            .sidebar {
                position: relative;
                top: 0;
                width: 100%;
                height: auto;
                bottom: auto;
                z-index: 1;
            }
            .sidebar h2 {
                text-align: center;
            }
            .main-content {
                margin-left: 0;
                flex-direction: column;
            }
            .content-column, .intro, .select-method, .wizard, .category, .manual, .module-actions, .cart-checkout {
                margin: 1rem 0;
            }
            .carousel-container {
                max-width: 100%;
                margin: 1rem 0;
            }
            .carousel-prev {
                left: 0;
            }
            .carousel-next {
                right: 0;
            }
        }
    </style>
</body>
</html>
